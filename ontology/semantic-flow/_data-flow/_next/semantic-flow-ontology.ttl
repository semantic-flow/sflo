@base <https://semantic-flow.github.io/ontology/semantic-flow/> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix dcterms: <http://purl.org/dc/terms/> .
@prefix dcat: <http://www.w3.org/ns/dcat#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix prov: <http://www.w3.org/ns/prov#> .
@prefix schema: <https://schema.org/> .
@prefix vann: <http://purl.org/vocab/vann/> .
@prefix sflo: <https://semantic-flow.github.io/ontology/semantic-flow/> .

<> a owl:Ontology ;
    dcterms:title "Semantic Flow Ontology" ;
    dcterms:description "The Semantic Flow ontology defines the classes and properties used for defining and describing semantic meshes." ;
    dcterms:creator <https://djradon.github.io/ns/djradon> ;
    owl:versionInfo "1" ;
    owl:versionIRI <https://semantic-flow.github.io/ontology/semantic-flow/_dataset-flow/v1/sflo_v1.ttl> ;
    vann:preferredNamespacePrefix "sflo" ;
    vann:preferredNamespaceUri "https://semantic-flow.github.io/ontology/semantic-flow/" .

#################################################################
#    Resource Classes 
#################################################################

# Base resource for all terms in this ontology
sflo:Resource a rdfs:Class ;
    rdfs:label "Resource" ;
    rdfs:comment "Abstract base class for all Semantic Flow resources. Provides fundamental identification and documentation affordances." .

# File-based resources (e.g., README.md, index.html, .trig distributions)
sflo:FileResource a rdfs:Class ;
    rdfs:subClassOf sflo:Resource ;
    rdfs:label "File Resource" ;
    rdfs:comment "A resource that locates and corresponds directly to a file." .

# Naming resources (folder-like, slash-terminated IRIs)
sflo:NamingResource a rdfs:Class ;
    rdfs:subClassOf sflo:Resource ;
    rdfs:label "Naming Resource" ;
    rdfs:comment "A resource that establishes a name, optionally denoting a non-file thing. Naming resources' IRIs end with a slash and may or may not have a referent." .

#################################################################
#    DocumentationResource Classes and Properties
#################################################################

# Classes 
sflo:DocumentationResource a rdfs:Class ;
    rdfs:subClassOf sflo:FileResource ;
    rdfs:label "Documentation Resource" ;
    rdfs:comment "Documentation files that provide human-readable information about resources. Abstract." .

sflo:ResourcePage a rdfs:Class ;
    rdfs:subClassOf sflo:DocumentationResource ;
    rdfs:label "Resource Page" ;
    rdfs:comment "Human-readable index.html pages that provide dereferenceability for NamingResources." .

sflo:Changelog a rdfs:Class ;
    rdfs:subClassOf sflo:DocumentationResource ;
    rdfs:label "Changelog" ;
    rdfs:comment "Changelog files that document version history and changes for resources." .

sflo:Readme a rdfs:Class ;
    rdfs:subClassOf sflo:DocumentationResource ;
    rdfs:label "Readme" ;
    rdfs:comment "Readme files that provide introductory documentation and usage information." .


# Properties
sflo:hasReadme a owl:ObjectProperty ;
    schema:domainIncludes sflo:NamingResource ;
    schema:rangeIncludes sflo:Readme ;
    rdfs:label "has readme" ;
    rdfs:comment "Associates a namespace resource with its README documentation file." .

sflo:hasChangelog a owl:ObjectProperty ;
    schema:domainIncludes sflo:NamingResource ;
    schema:rangeIncludes sflo:Changelog ;
    rdfs:label "has changelog" ;
    rdfs:comment "Associates a namespace resource with its changelog documentation file." .



#################################################################
#    Mesh Structure Classes
#################################################################

# Mesh Node (naming resource)
sflo:MeshNode a rdfs:Class ;
    rdfs:subClassOf sflo:NamingResource ;
    rdfs:label "Mesh Node" ;
    rdfs:comment "Structural units that organize and contain other resources. Nodes form the structure of the mesh." .





#################################################################
#    Object Properties 
#################################################################


#################################################################
#    Data Properties 
#################################################################


#################################################################
#    Disjointness Axioms 
#################################################################

# File vs Naming resources are disjoint
[ a owl:AllDisjointClasses ;
  owl:members ( sflo:FileResource sflo:NamingResource )
] .


#################################################################
#    SHACL Constraints 
#################################################################


### NamingResource: IRI must end with a slash (/)
sflo:NamingResourceShape a sh:NodeShape ;
    sh:targetClass sflo:NamingResource ;
    sh:nodeKind sh:IRI ;
    sh:sparql [
        sh:message "NamingResource IRI must end with a slash (/)." ;
        sh:select """
            SELECT ?this WHERE {
                FILTER ( !STRENDS(STR(?this), "/") )
            }
        """ ;
    ] .

### FileResource: IRI must NOT end with a slash (/)
sflo:FileResourceShape a sh:NodeShape ;
    sh:targetClass sflo:FileResource ;
    sh:nodeKind sh:IRI ;
    sh:sparql [
        sh:message "FileResource IRI must not end with a slash (/)." ;
        sh:select """
            SELECT ?this WHERE {
                FILTER ( STRENDS(STR(?this), "/") )
            }
        """ ;
    ] .
    

#################################################################
#    TODO (Next Slices)
#################################################################
# Slice 3 (Node Model):
# - Classes: sflo:NodeComponent, sflo:Handle, sflo:HandleAsComponent,
#            sflo:Namespace, sflo:Reference, sflo:Data, sflo:NodeFlow
# - Properties: sflo:hasElement, sflo:isHandleFor, sflo:hasHandle, sflo:hasFlow, sflo:hasSlug
# - SHACL: Node gets exactly one HandleAsComponent; slug kebab-case pattern
#
# Slice 4 (Flow / Temporal Model):
# - Classes: sflo:Snapshot, sflo:VersionSnapshot, sflo:ConfigFlow, sflo:MetadataFlow,
#            sflo:ReferenceFlow, sflo:DatasetFlow
# - Properties: sflo:hasSnapshot, sflo:hasVersionSnapshot, sflo:hasPreviousSnapshot,
#               sflo:versioningState, sflo:hasConfig, sflo:hasMetadata,
#               sflo:hasReference, sflo:hasData
# - SHACL: Distribution ↔ Snapshot ↔ Flow constraints; versioning state enumeration
