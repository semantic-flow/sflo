<h1 id="unified-dataset">unified dataset<a aria-hidden="true" class="anchor-heading icon-link" href="#unified-dataset"></a></h1>
<h2 id="overview">Overview<a aria-hidden="true" class="anchor-heading icon-link" href="#overview"></a></h2>
<p>A <strong>unified dataset</strong> provides convenient aggregated access to a mesh node's current state by combining data from its non-config <a href="/notes/rregmt56znauz71qgypet6a">flows</a> (meta, ref, data) into a single <a href="/notes/8t3swuswoi81yuzo2bnecy9">flow snapshot</a> with corresponding distribution files.</p>
<p>Since it is fundamentally a combination, it only makes sense to generate a unified component for nodes that have more than one component, i.e., not <a href="/notes/lvbmfa3hjpzxjv1iaaugsnb">namespace node</a>.</p>
<h2 id="component-or-not">Component or Not?<a aria-hidden="true" class="anchor-heading icon-link" href="#component-or-not"></a></h2>
<p>Like all components:</p>
<ul>
<li>its associated with a <a href="/notes/8hmkiyjtsey7z8y5oi5xdxm">MeshNode</a></li>
<li>its a DatasetSeries that consists of "state layers" that have distributions</li>
<li>its metadata is kept in its sibling <a href="/notes/0y6p8e594peoult03gobm94">metadata flow</a></li>
<li>it has independent versioning, and a _current snapshot which duplicates the latest version</li>
</ul>
<p>Like the metadata flow: </p>
<ul>
<li>it is generated by the <a href="/notes/gyflcnmoj4kr2w9mi740yxq">system</a> and so is not considered <a href="/notes/rc1wsoryoff9ffxb8wwbf9p">user-modifiable</a></li>
<li>no _next snapshot (or _next is just temporary during weave)</li>
<li>System components always version together in response to user component changes.</li>
</ul>
<p>Unlike other components:</p>
<ul>
<li>it doesn't contain any data of its own; it's more a view than a source</li>
</ul>
<h2 id="architecture">Architecture<a aria-hidden="true" class="anchor-heading icon-link" href="#architecture"></a></h2>
<h3 id="iri-structure--single-referent-compliance">IRI Structure &#x26; Single Referent Compliance<a aria-hidden="true" class="anchor-heading icon-link" href="#iri-structure--single-referent-compliance"></a></h3>
<ul>
<li><strong>Node IRI</strong> (<code>ns/djradon/bio-dataset/</code>) refers to its semantic entity (abstract dataset or thing)</li>
<li><strong>Unified Component IRI</strong> (<code>ns/djradon/bio-dataset/_unified/</code>) refers to the aggregated DatasetSeries</li>
<li><strong>Distribution files</strong> are serializations of the unified dataset</li>
<li><strong>No violation</strong> of <a href="/notes/4ado7w6mwrrcphy9p1kpfa3">single referent principle</a></li>
</ul>
<h3 id="content-composition">Content Composition<a aria-hidden="true" class="anchor-heading icon-link" href="#content-composition"></a></h3>
<pre class="language-turtle"><code class="language-turtle"><span class="token comment"># Example unified dataset content</span>
<span class="token keyword">@prefix</span> <span class="token function"><span class="token prefix">flow<span class="token punctuation">:</span></span></span> <span class="token url"><span class="token punctuation">&#x3C;</span>https://semantic-flow.github.io/sflo-ontology/<span class="token punctuation">></span></span> <span class="token punctuation">.</span>

<span class="token comment"># Unified dataset describes its aggregation</span>
<span class="token url"><span class="token punctuation">&#x3C;</span>ns/djradon/bio-dataset/_unified/<span class="token punctuation">></span></span> <span class="token keyword">a</span> <span class="token function"><span class="token prefix">dcat<span class="token punctuation">:</span></span><span class="token local-name">Dataset</span></span> <span class="token punctuation">;</span>
  <span class="token function"><span class="token prefix">dct<span class="token punctuation">:</span></span><span class="token local-name">title</span></span> <span class="token string">"Unified view of bio-dataset node"</span> <span class="token punctuation">;</span>
  <span class="token function"><span class="token prefix">flow<span class="token punctuation">:</span></span><span class="token local-name">aggregatedFrom</span></span> <span class="token punctuation">[</span>
    <span class="token function"><span class="token prefix">flow<span class="token punctuation">:</span></span><span class="token local-name">metaDataset</span></span> <span class="token url"><span class="token punctuation">&#x3C;</span>ns/djradon/bio-dataset/_meta-component/v2/<span class="token punctuation">></span></span> <span class="token punctuation">;</span>
    <span class="token function"><span class="token prefix">flow<span class="token punctuation">:</span></span><span class="token local-name">dataDataset</span></span> <span class="token url"><span class="token punctuation">&#x3C;</span>ns/djradon/bio-dataset/_data-component/v1/<span class="token punctuation">></span></span> <span class="token punctuation">;</span>
    <span class="token function"><span class="token prefix">flow<span class="token punctuation">:</span></span><span class="token local-name">aggregatedAt</span></span> <span class="token string">"2025-01-03T19:06:34Z"</span><span class="token punctuation">^^</span><span class="token function"><span class="token prefix">xsd<span class="token punctuation">:</span></span><span class="token local-name">dateTime</span></span>
  <span class="token punctuation">]</span> <span class="token punctuation">.</span>

<span class="token url"><span class="token punctuation">&#x3C;</span>ns/djradon/bio-dataset/_meta/_current/<span class="token punctuation">></span></span> <span class="token punctuation">{</span>
  <span class="token comment"># Current meta dataset content</span>
<span class="token punctuation">}</span>

<span class="token url"><span class="token punctuation">&#x3C;</span>ns/djradon/bio-dataset/_data/_current/<span class="token punctuation">></span></span> <span class="token punctuation">{</span>
  <span class="token comment"># Current data dataset content</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="benefits">Benefits<a aria-hidden="true" class="anchor-heading icon-link" href="#benefits"></a></h2>
<h3 id="developer-experience">Developer Experience<a aria-hidden="true" class="anchor-heading icon-link" href="#developer-experience"></a></h3>
<ul>
<li><strong>Single file access</strong>: Complete node state in one distribution</li>
<li><strong>Atomic consistency</strong>: Guaranteed consistent snapshot of all components</li>
<li><strong>Simplified client code</strong>: No need to understand internal node structure</li>
</ul>
<h3 id="performance">Performance<a aria-hidden="true" class="anchor-heading icon-link" href="#performance"></a></h3>
<ul>
<li><strong>Reduced HTTP requests</strong>: One file instead of 3+ component requests</li>
<li><strong>Bandwidth efficiency</strong>: Optimized for common "give me everything about this node" use case</li>
</ul>
<h3 id="provenance">Provenance<a aria-hidden="true" class="anchor-heading icon-link" href="#provenance"></a></h3>
<ul>
<li><strong>Version tracking</strong>: Metadata about which flow versions were aggregated</li>
<li><strong>Audit trail</strong>: Clear record of what was combined and when</li>
<li><strong>Debugging</strong>: Easy to see complete node state at specific point in time</li>
</ul>
<h2 id="implementation-considerations">Implementation Considerations<a aria-hidden="true" class="anchor-heading icon-link" href="#implementation-considerations"></a></h2>
<h3 id="generation-strategy">Generation Strategy<a aria-hidden="true" class="anchor-heading icon-link" href="#generation-strategy"></a></h3>
<ul>
<li><strong>Event-driven</strong>: Regenerate on any version-bumping weave</li>
</ul>
<h3 id="synchronization">Synchronization<a aria-hidden="true" class="anchor-heading icon-link" href="#synchronization"></a></h3>
<ul>
<li><strong>Consistency checks</strong>: Validate component datasets before aggregation</li>
<li><strong>Error handling</strong>: Graceful degradation when components missing/invalid</li>
<li><strong>Race conditions</strong>: Handle concurrent updates to components</li>
</ul>
<h3 id="storage">Storage<a aria-hidden="true" class="anchor-heading icon-link" href="#storage"></a></h3>
<ul>
<li><strong>Disk space</strong>: Additional storage overhead for duplicated data</li>
</ul>
<h2 id="technical-requirements">Technical Requirements<a aria-hidden="true" class="anchor-heading icon-link" href="#technical-requirements"></a></h2>
<h3 id="file-naming">File Naming<a aria-hidden="true" class="anchor-heading icon-link" href="#file-naming"></a></h3>
<ul>
<li>Pattern: <code>{node-name}_unified.{format}</code> (e.g., <code>bio-dataset_unified.trig</code>)</li>
<li>Consistent across all node types</li>
<li>Clear differentiation from component dataset files</li>
</ul>
<h3 id="content-validation">Content Validation<a aria-hidden="true" class="anchor-heading icon-link" href="#content-validation"></a></h3>
<ul>
<li><strong>Component availability</strong>: All required components must exist</li>
<li><strong>RDF validity</strong>: Generated content must be valid RDF</li>
<li><strong>Graph organization</strong>: Clear separation of component data via named graphs</li>
</ul>
<p><strong>Why not always use a unified dataset?</strong></p>
<ul>
<li><strong>Node type detection</strong>: Folder existence (<code>_ref/</code> vs <code>_data/</code>) indicates node type without parsing</li>
<li><strong>Granular access</strong>: Clients can request specific components (meta-only, data-only)</li>
<li><strong>Independent versioning</strong>: Components can evolve at different rates</li>
<li><strong>Clear semantics</strong>: Each dataset has focused, well-defined purpose</li>
</ul>
<p><strong>Why bother with a unified dataset?</strong></p>
<p><strong>Unified approach benefits</strong>:</p>
<ul>
<li><strong>Simplicity</strong>: Single dataset per node reduces complexity</li>
<li><strong>Atomic consistency</strong>: All components always synchronized</li>
</ul>
<h2 id="related-concepts">Related Concepts<a aria-hidden="true" class="anchor-heading icon-link" href="#related-concepts"></a></h2>
<ul>
<li><a href="/notes/8hmkiyjtsey7z8y5oi5xdxm">MeshNode</a> - Base mesh node architecture</li>
<li><a href="/notes/0y6p8e594peoult03gobm94">metadata flow</a> - Centralized metadata</li>
<li><a href="/notes/0n1lq6aq1gskj46bpcx9h4h">layer distribution</a> - Distribution file concepts</li>
</ul>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/notes/pqjdlyd8g80x3yr9o3p82mj">node config</a></li>
<li><a href="/notes/9c27yly4ed3ju7msf8luhge">mesh element</a></li>
<li><a href="/notes/8hmkiyjtsey7z8y5oi5xdxx">data node</a></li>
</ul>