<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/sflo/favicon.ico"/><title>2025 11 28_refine Createnode</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="A dendron-based wiki for sflo"/><meta property="og:title" content="2025 11 28_refine Createnode"/><meta property="og:description" content="A dendron-based wiki for sflo"/><meta property="og:url" content="https://semantic-flow.github.io/sflo/notes/k2apr2q5ibovesxgkhhgkmp/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="11/28/2025"/><meta property="article:modified_time" content="11/28/2025"/><link rel="canonical" href="https://semantic-flow.github.io/sflo/notes/k2apr2q5ibovesxgkhhgkmp/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/sflo/_next/static/css/16a873435e51c1c5.css" as="style"/><link rel="stylesheet" href="/sflo/_next/static/css/16a873435e51c1c5.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/sflo/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/sflo/_next/static/chunks/webpack-ab072f314bee576a.js" defer=""></script><script src="/sflo/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/sflo/_next/static/chunks/main-e7d9c70dd8957f37.js" defer=""></script><script src="/sflo/_next/static/chunks/pages/_app-a6232c6cf10e06f7.js" defer=""></script><script src="/sflo/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/sflo/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/sflo/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/sflo/_next/static/stable-build-id/_buildManifest.js" defer=""></script><script src="/sflo/_next/static/stable-build-id/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="2025-11-28_refine-createnode">2025 11 28_refine Createnode<a aria-hidden="true" class="anchor-heading icon-link" href="#2025-11-28_refine-createnode"></a></h1>
<pre class="language-md"><code class="language-md">
<span class="token title important"><span class="token punctuation">##</span> Prompt</span>

We already have an architecture draft in <span class="token code-snippet code keyword">`architecture-plan-rdfsource-createnode.md`</span>. Use it as a <span class="token bold"><span class="token punctuation">**</span><span class="token content">structural reference</span><span class="token punctuation">**</span></span>, but treat the rules below as <span class="token bold"><span class="token punctuation">**</span><span class="token content">authoritative</span><span class="token punctuation">**</span></span> where there is any conflict.

The goal of this task is to:

<span class="token list punctuation">1.</span> Refine <span class="token code-snippet code keyword">`createNode`</span> so that it:
   <span class="token list punctuation">-</span> scaffolds a mesh node’s directory structure,
   <span class="token list punctuation">-</span> writes <span class="token bold"><span class="token punctuation">**</span><span class="token content">_working</span><span class="token punctuation">**</span></span> shots (where inputs are provided),
   <span class="token list punctuation">-</span> does <span class="token bold"><span class="token punctuation">**</span><span class="token content">not</span><span class="token punctuation">**</span></span> write any snapshots (v1, _default) for any flow.
<span class="token list punctuation">2.</span> Ensure <span class="token code-snippet code keyword">`_meta`</span> exists but contains <span class="token bold"><span class="token punctuation">**</span><span class="token content">no RDF</span><span class="token punctuation">**</span></span>; metadata snapshots are created only by later <span class="token bold"><span class="token punctuation">**</span><span class="token content">weave</span><span class="token punctuation">**</span></span> operations.
<span class="token list punctuation">3.</span> Create default <span class="token code-snippet code keyword">`index.html`</span> resource pages for:
   <span class="token list punctuation">-</span> the node itself,
   <span class="token list punctuation">-</span> each flow directory that is created,
   <span class="token list punctuation">-</span> and (optionally) each shot directory, using a platform default template.
<span class="token list punctuation">4.</span> Make provenance defaults come exclusively from <span class="token code-snippet code keyword">`_cfg-op`</span> (operational config), not from a separate provenance bundle.
<span class="token list punctuation">5.</span> Preserve the existing RdfSource / parsing semantics direction (file:/// base, mesh-native JSON-LD).

This sets us up so that:

<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`createNode`</span> establishes a <span class="token italic"><span class="token punctuation">*</span><span class="token content">reviewable, un-woven node</span><span class="token punctuation">*</span></span> with optional <span class="token code-snippet code keyword">`_working`</span> data and HTML resource pages.
<span class="token list punctuation">-</span> The first actual weave can be a <span class="token bold"><span class="token punctuation">**</span><span class="token content">regular weave</span><span class="token punctuation">**</span></span>—no special “initialization weave” concept is needed.

<span class="token hr punctuation">---</span>

<span class="token title important"><span class="token punctuation">##</span> Authoritative behavior for createNode</span>

<span class="token title important"><span class="token punctuation">###</span> 1. Required vs optional flows</span>

For a newly created node:

<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_meta/`</span> is <span class="token bold"><span class="token punctuation">**</span><span class="token content">mandatory</span><span class="token punctuation">**</span></span> (always created).
<span class="token list punctuation">-</span> All other flow directories are <span class="token bold"><span class="token punctuation">**</span><span class="token content">optional</span><span class="token punctuation">**</span></span>:
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_ref/`</span>
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_payload/`</span>
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_cfg-op/`</span>
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_cfg-inh/`</span>

<span class="token code-snippet code keyword">`createNode`</span>:

<span class="token list punctuation">-</span> MUST always create <span class="token code-snippet code keyword">`_meta/`</span> with an empty <span class="token code-snippet code keyword">`_meta/_default/`</span> directory (no RDF content).
<span class="token list punctuation">-</span> MUST NOT create <span class="token code-snippet code keyword">`_meta/_working`</span> at all.
<span class="token list punctuation">-</span> MAY create other flow directories only when needed (inputs provided, or design choice to always scaffold them).

<span class="token title important"><span class="token punctuation">###</span> 2. Snapshots vs working shots</span>

Global rule to enforce:

<span class="token list punctuation">-</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">“Weaves write snapshots.”</span><span class="token punctuation">**</span></span>
<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`createNode`</span> is <span class="token bold"><span class="token punctuation">**</span><span class="token content">not</span><span class="token punctuation">**</span></span> a weave; it performs no snapshots.

Concretely:

<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`createNode`</span> MUST NOT write:
  <span class="token list punctuation">-</span> any <span class="token code-snippet code keyword">`v1`</span> directories,
  <span class="token list punctuation">-</span> any <span class="token code-snippet code keyword">`_default`</span> distributions for any flow,
  <span class="token list punctuation">-</span> any provenance activities in <span class="token code-snippet code keyword">`_meta`</span>.

Instead:

<span class="token list punctuation">-</span> For any flow where input is provided (reference/payload/config), <span class="token code-snippet code keyword">`createNode`</span>:
  <span class="token list punctuation">-</span> MUST create a <span class="token code-snippet code keyword">`_working/`</span> shot directory for that flow,
  <span class="token list punctuation">-</span> MUST write a <span class="token bold"><span class="token punctuation">**</span><span class="token content">mesh-native JSON-LD distribution</span><span class="token punctuation">**</span></span> there,
  <span class="token list punctuation">-</span> MUST use the filename conventions below.

<span class="token title important"><span class="token punctuation">###</span> 3. Flow dirs, snaps, filenames (Option 1 + exact flow slugs)</span>

Flow directory slugs (fixed):

<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_meta`</span>
<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_ref`</span>
<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_payload`</span>
<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_cfg-op`</span>
<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_cfg-inh`</span>

Node slug:

<span class="token list punctuation">-</span> Derived from the node folder name.

File naming:

<span class="token list punctuation">-</span> Payload:
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_payload/_working/&#x3C;nodeSlug>.jsonld`</span>
  <span class="token list punctuation">-</span> (later, weaves will write <span class="token code-snippet code keyword">`_payload/vN/&#x3C;nodeSlug>.jsonld`</span> and <span class="token code-snippet code keyword">`_payload/_default/&#x3C;nodeSlug>.jsonld`</span>)
<span class="token list punctuation">-</span> Other flows:
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_ref/_working/&#x3C;nodeSlug>_ref.jsonld`</span>
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_cfg-op/_working/&#x3C;nodeSlug>_cfg-op.jsonld`</span>
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_cfg-inh/_working/&#x3C;nodeSlug>_cfg-inh.jsonld`</span>
<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_meta`</span>:
  <span class="token list punctuation">-</span> For <span class="token bold"><span class="token punctuation">**</span><span class="token content">this task</span><span class="token punctuation">**</span></span>, <span class="token code-snippet code keyword">`createNode`</span> <span class="token bold"><span class="token punctuation">**</span><span class="token content">does not</span><span class="token punctuation">**</span></span> write any JSON-LD inside <span class="token code-snippet code keyword">`_meta`</span> at all.
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`_meta/_default/`</span> is created as an empty directory; snapshots will be created by weaves later.

No <span class="token code-snippet code keyword">`_meta/_working`</span> directory.

<span class="token title important"><span class="token punctuation">###</span> 4. RdfSource and parsing semantics (must keep)</span>

Continue to implement/extend the previously agreed model:

<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`RdfSource`</span> discriminated union:
  <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`kind: 'file' | 'url' | 'inline'`</span> with <span class="token code-snippet code keyword">`syntax`</span> hint.
<span class="token list punctuation">-</span> Parsing behavior:
  <span class="token list punctuation">-</span> For <span class="token code-snippet code keyword">`kind: 'file'`</span>:
    <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`documentIri = file:///absolute/path/to/file`</span>
    <span class="token list punctuation">-</span> parse with <span class="token code-snippet code keyword">`baseIri = documentIri`</span>.
  <span class="token list punctuation">-</span> For <span class="token code-snippet code keyword">`kind: 'url'`</span>:
    <span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`documentIri = url`</span>.
  <span class="token list punctuation">-</span> For <span class="token code-snippet code keyword">`kind: 'inline'`</span>:
    <span class="token list punctuation">-</span> use a synthetic <span class="token code-snippet code keyword">`file:///virtual/...`</span> base (document in comments).
<span class="token list punctuation">-</span> Mesh-native JSON-LD serialization:
  <span class="token list punctuation">-</span> no <span class="token code-snippet code keyword">`@base`</span> in context,
  <span class="token list punctuation">-</span> local IRIs relative to the chosen target base,
  <span class="token list punctuation">-</span> external IRIs absolute.

<span class="token code-snippet code keyword">`createNode`</span> must use <span class="token code-snippet code keyword">`RdfSource`</span> + debasing logic to populate <span class="token code-snippet code keyword">`_working`</span> distributions when inputs are provided.

<span class="token title important"><span class="token punctuation">###</span> 5. Provenance defaults: only via operational config</span>

Remove or ignore <span class="token code-snippet code keyword">`ProvenanceBundleInput`</span> in <span class="token code-snippet code keyword">`createNode`</span>:

<span class="token list punctuation">-</span> <span class="token code-snippet code keyword">`createNode`</span> options should look like:

  ```ts
  export interface CreateNodeOptions {
    payloadDataset?: RdfSource;
    referenceDataset?: RdfSource;
    operationalConfig?: RdfSource;
    inheritableConfig?: RdfSource;

<span class="token code keyword">    allowNonEmpty?: boolean;</span>

<span class="token code keyword">    // Optional: node README content or path (see below)
    readme?: string;      // inline markdown
    readmePath?: string;  // file path for markdown</span>
  }
</code></pre>
<ul>
<li>
<p>If <code>operationalConfig</code> is provided:</p>
<ul>
<li>Parse it as RDF via <code>RdfSource</code> and write <code>_cfg-op/_working/&#x3C;nodeSlug>_cfg-op.jsonld</code> in mesh-native form.</li>
<li>This config MAY contain “provenance defaults” (rightsHolder, license, default agents, etc.), but <strong>no actual weave events</strong>.</li>
</ul>
</li>
<li>
<p>Actual weave events and PROV activities will be created later by a generic weave operation consuming <code>_cfg-op</code>, <code>_working</code> datasets, etc.</p>
</li>
</ul>
<h3 id="6-readme-and-starter-kits">6. README and starter kits<a aria-hidden="true" class="anchor-heading icon-link" href="#6-readme-and-starter-kits"></a></h3>
<p>For this task, support at least:</p>
<ul>
<li>
<p>Optional README content for the node itself:</p>
<ul>
<li><code>readme</code> (inline markdown) or <code>readmePath</code> (file).</li>
</ul>
</li>
<li>
<p>Do <strong>not</strong> treat README as RDF; it’s normal content to be integrated into the node’s resource page (index.html).</p>
</li>
<li>
<p>You do <em>not</em> need to implement zipped starter kits now; just keep the architecture flexible enough that <code>createNode</code> could later accept a “starter node bundle” and unpack it before applying additional config.</p>
</li>
</ul>
<hr>
<h2 id="resource-pages-indexhtml-behavior">Resource pages (index.html) behavior<a aria-hidden="true" class="anchor-heading icon-link" href="#resource-pages-indexhtml-behavior"></a></h2>
<p>We want dereferenceability even before the first weave.</p>
<h3 id="7-indexhtml-generation">7. index.html generation<a aria-hidden="true" class="anchor-heading icon-link" href="#7-indexhtml-generation"></a></h3>
<p><code>createNode</code> should generate basic <code>index.html</code> files using a “platform default” template for:</p>
<ul>
<li>
<p>The node root folder:</p>
<ul>
<li><code>&#x3C;nodePath>/index.html</code></li>
</ul>
</li>
<li>
<p>Each created flow directory:</p>
<ul>
<li><code>&#x3C;nodePath>/_meta/index.html</code></li>
<li><code>&#x3C;nodePath>/_payload/index.html</code> (if created)</li>
<li><code>&#x3C;nodePath>/_ref/index.html</code> (if created)</li>
<li>etc.</li>
</ul>
</li>
<li>
<p>Optionally, each shot directory created at this stage:</p>
<ul>
<li><code>&#x3C;nodePath>/_payload/_working/index.html</code></li>
<li><code>&#x3C;nodePath>/_cfg-op/_working/index.html</code></li>
<li>etc.</li>
</ul>
</li>
</ul>
<p>Template requirements (minimal for now):</p>
<ul>
<li>
<p>Node <code>index.html</code>:</p>
<ul>
<li>Mentions the node slug.</li>
<li>Links to any existing flow directories as “NamingResources” / “FileResources” (no need for full ontology terms, just human-readable for now).</li>
<li>Optionally renders README content if provided (simple markdown → HTML is enough; can be naive).</li>
</ul>
</li>
<li>
<p>Flow <code>index.html</code>:</p>
<ul>
<li>Identifies the flow by slug (<code>_payload</code>, <code>_ref</code>, <code>_cfg-op</code>, etc.).</li>
<li>Links to any <code>_working</code> distributions present (plain file links).</li>
</ul>
</li>
</ul>
<p>These templates can be simple functions or static HTML skeletons with minimal logic; the goal is just to ensure:</p>
<ul>
<li>every directory is dereferenceable over HTTP,</li>
<li>there’s enough structure that future weaves can build richer resource pages without breaking anything.</li>
</ul>
<hr>
<h2 id="what-needs-to-be-changed-vs-the-original-architecture-plan">What needs to be changed vs the original architecture plan<a aria-hidden="true" class="anchor-heading icon-link" href="#what-needs-to-be-changed-vs-the-original-architecture-plan"></a></h2>
<p>When you implement this task, please:</p>
<ol>
<li>
<p><strong>Remove</strong> snapshot generation from <code>createNode</code>:</p>
<ul>
<li>No <code>_meta/v1</code>, no <code>_meta/_default</code> distributions.</li>
<li>No <code>v1</code> snapshots for <code>_payload</code>, <code>_ref</code>, <code>_cfg-*</code>.</li>
</ul>
</li>
<li>
<p><strong>Ensure <code>_meta</code> is mandatory</strong>, but only the directory and <code>_default/</code> subdir exist; no RDF.</p>
</li>
<li>
<p><strong>Add <code>_working</code> shots</strong> for flows where inputs are provided, using the naming rules above.</p>
</li>
<li>
<p><strong>Drop <code>ProvenanceBundleInput</code></strong> from <code>createNode</code>; provenance defaults belong in <code>_cfg-op/_working</code>.</p>
</li>
<li>
<p><strong>Add support for optional Node README</strong> (inline or from file) at <code>createNode</code> time, store it as nodename/README.md</p>
</li>
<li>
<p><strong>Generate default <code>index.html</code></strong> in node root (using README.md if present, and linking to created flow and FlowShot dirs).</p>
</li>
</ol>
<p>You can either refactor the existing <code>createNode</code> implementation/plan or restart it with these rules; given the amount of change, a <strong>surgical refactor</strong> is probably reasonable:</p>
<ul>
<li>Keep file locations, error types, and basic directory scaffolding logic.</li>
<li>Remove snapshot-writing logic and provenance bundles.</li>
<li>Insert <code>_working</code> shot writing + <code>index.html</code> generation.</li>
</ul>
<hr>
<h2 id="success-criteria">Success criteria<a aria-hidden="true" class="anchor-heading icon-link" href="#success-criteria"></a></h2>
<p>This task is complete when:</p>
<ol>
<li>
<p><code>createNode</code>:</p>
<ul>
<li>Creates <code>_meta/_default/</code> as an empty directory.</li>
<li>Creates other flow dirs only as needed.</li>
<li>Writes <code>_working</code> distributions (mesh-native JSON-LD) for any flows where <code>RdfSource</code> inputs are provided.</li>
<li>Does not write any snapshots (<code>v1</code>, <code>_default</code> distributions) or metadata RDF.</li>
</ul>
</li>
<li>
<p>Optional <code>operationalConfig</code> is written to <code>_cfg-op/_working/&#x3C;nodeSlug>_cfg-op.jsonld</code> and not used to generate any PROV events yet.</p>
</li>
<li>
<p>Optional README is accepted and integrated into the node’s <code>index.html</code> page.</p>
</li>
<li>
<p><code>index.html</code> exists in:</p>
<ul>
<li>node root,</li>
<li><code>_meta/</code>,</li>
<li>each non-empty flow dir,</li>
<li>and each <code>_working</code> shot dir created by <code>createNode</code>.</li>
</ul>
</li>
<li>
<p>All affected tests are updated or added to reflect:</p>
<ul>
<li><code>_meta</code> is mandatory but RDF-free after <code>createNode</code>,</li>
<li>no snapshots exist after <code>createNode</code>,</li>
<li><code>_working</code> distributions appear correctly when inputs are provided,</li>
<li><code>index.html</code> gets created in the expected locations.</li>
</ul>
</li>
</ol>
<pre><code></code></pre></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#6-readme-and-starter-kits" title="6. README and starter kits">6. README and starter kits</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#resource-pages-indexhtml-behavior" title="Resource pages (index.html) behavior">Resource pages (index.html) behavior</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#7-indexhtml-generation" title="7. index.html generation">7. index.html generation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#what-needs-to-be-changed-vs-the-original-architecture-plan" title="What needs to be changed vs the original architecture plan">What needs to be changed vs the original architecture plan</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#success-criteria" title="Success criteria">Success criteria</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"k2apr2q5ibovesxgkhhgkmp","title":"2025 11 28_refine Createnode","desc":"","updated":1764346560192,"created":1764346329068,"custom":{},"fname":"task.2025-11-28_refine-createnode","type":"note","vault":{"fsPath":"documentation","selfContained":false,"name":"sflo"},"contentHash":"4bd1f6df919199b0f80b9165e01d8c4b","links":[],"anchors":{"6-readme-and-starter-kits":{"type":"header","text":"6. README and starter kits","value":"6-readme-and-starter-kits","line":153,"column":0,"depth":3},"resource-pages-indexhtml-behavior":{"type":"header","text":"Resource pages (index.html) behavior","value":"resource-pages-indexhtml-behavior","line":165,"column":0,"depth":2},"7-indexhtml-generation":{"type":"header","text":"7. index.html generation","value":"7-indexhtml-generation","line":169,"column":0,"depth":3},"what-needs-to-be-changed-vs-the-original-architecture-plan":{"type":"header","text":"What needs to be changed vs the original architecture plan","value":"what-needs-to-be-changed-vs-the-original-architecture-plan","line":208,"column":0,"depth":2},"success-criteria":{"type":"header","text":"Success criteria","value":"success-criteria","line":230,"column":0,"depth":2}},"children":[],"parent":"tasks","data":{},"schema":{"schemaId":"task","moduleId":"task"}},"body":"\u003ch1 id=\"2025-11-28_refine-createnode\"\u003e2025 11 28_refine Createnode\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#2025-11-28_refine-createnode\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003cpre class=\"language-md\"\u003e\u003ccode class=\"language-md\"\u003e\n\u003cspan class=\"token title important\"\u003e\u003cspan class=\"token punctuation\"\u003e##\u003c/span\u003e Prompt\u003c/span\u003e\n\nWe already have an architecture draft in \u003cspan class=\"token code-snippet code keyword\"\u003e`architecture-plan-rdfsource-createnode.md`\u003c/span\u003e. Use it as a \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003estructural reference\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e, but treat the rules below as \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003eauthoritative\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e where there is any conflict.\n\nThe goal of this task is to:\n\n\u003cspan class=\"token list punctuation\"\u003e1.\u003c/span\u003e Refine \u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e so that it:\n   \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e scaffolds a mesh node’s directory structure,\n   \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e writes \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003e_working\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e shots (where inputs are provided),\n   \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e does \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003enot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e write any snapshots (v1, _default) for any flow.\n\u003cspan class=\"token list punctuation\"\u003e2.\u003c/span\u003e Ensure \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta`\u003c/span\u003e exists but contains \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003eno RDF\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e; metadata snapshots are created only by later \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003eweave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e operations.\n\u003cspan class=\"token list punctuation\"\u003e3.\u003c/span\u003e Create default \u003cspan class=\"token code-snippet code keyword\"\u003e`index.html`\u003c/span\u003e resource pages for:\n   \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e the node itself,\n   \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e each flow directory that is created,\n   \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e and (optionally) each shot directory, using a platform default template.\n\u003cspan class=\"token list punctuation\"\u003e4.\u003c/span\u003e Make provenance defaults come exclusively from \u003cspan class=\"token code-snippet code keyword\"\u003e`_cfg-op`\u003c/span\u003e (operational config), not from a separate provenance bundle.\n\u003cspan class=\"token list punctuation\"\u003e5.\u003c/span\u003e Preserve the existing RdfSource / parsing semantics direction (file:/// base, mesh-native JSON-LD).\n\nThis sets us up so that:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e establishes a \u003cspan class=\"token italic\"\u003e\u003cspan class=\"token punctuation\"\u003e*\u003c/span\u003e\u003cspan class=\"token content\"\u003ereviewable, un-woven node\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e*\u003c/span\u003e\u003c/span\u003e with optional \u003cspan class=\"token code-snippet code keyword\"\u003e`_working`\u003c/span\u003e data and HTML resource pages.\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e The first actual weave can be a \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003eregular weave\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e—no special “initialization weave” concept is needed.\n\n\u003cspan class=\"token hr punctuation\"\u003e---\u003c/span\u003e\n\n\u003cspan class=\"token title important\"\u003e\u003cspan class=\"token punctuation\"\u003e##\u003c/span\u003e Authoritative behavior for createNode\u003c/span\u003e\n\n\u003cspan class=\"token title important\"\u003e\u003cspan class=\"token punctuation\"\u003e###\u003c/span\u003e 1. Required vs optional flows\u003c/span\u003e\n\nFor a newly created node:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta/`\u003c/span\u003e is \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003emandatory\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e (always created).\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e All other flow directories are \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003eoptional\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_ref/`\u003c/span\u003e\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_payload/`\u003c/span\u003e\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_cfg-op/`\u003c/span\u003e\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_cfg-inh/`\u003c/span\u003e\n\n\u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e MUST always create \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta/`\u003c/span\u003e with an empty \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta/_default/`\u003c/span\u003e directory (no RDF content).\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e MUST NOT create \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta/_working`\u003c/span\u003e at all.\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e MAY create other flow directories only when needed (inputs provided, or design choice to always scaffold them).\n\n\u003cspan class=\"token title important\"\u003e\u003cspan class=\"token punctuation\"\u003e###\u003c/span\u003e 2. Snapshots vs working shots\u003c/span\u003e\n\nGlobal rule to enforce:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003e“Weaves write snapshots.”\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e is \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003enot\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e a weave; it performs no snapshots.\n\nConcretely:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e MUST NOT write:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e any \u003cspan class=\"token code-snippet code keyword\"\u003e`v1`\u003c/span\u003e directories,\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e any \u003cspan class=\"token code-snippet code keyword\"\u003e`_default`\u003c/span\u003e distributions for any flow,\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e any provenance activities in \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta`\u003c/span\u003e.\n\nInstead:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e For any flow where input is provided (reference/payload/config), \u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e MUST create a \u003cspan class=\"token code-snippet code keyword\"\u003e`_working/`\u003c/span\u003e shot directory for that flow,\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e MUST write a \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003emesh-native JSON-LD distribution\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e there,\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e MUST use the filename conventions below.\n\n\u003cspan class=\"token title important\"\u003e\u003cspan class=\"token punctuation\"\u003e###\u003c/span\u003e 3. Flow dirs, snaps, filenames (Option 1 + exact flow slugs)\u003c/span\u003e\n\nFlow directory slugs (fixed):\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta`\u003c/span\u003e\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_ref`\u003c/span\u003e\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_payload`\u003c/span\u003e\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_cfg-op`\u003c/span\u003e\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_cfg-inh`\u003c/span\u003e\n\nNode slug:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e Derived from the node folder name.\n\nFile naming:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e Payload:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_payload/_working/\u0026#x3C;nodeSlug\u003e.jsonld`\u003c/span\u003e\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e (later, weaves will write \u003cspan class=\"token code-snippet code keyword\"\u003e`_payload/vN/\u0026#x3C;nodeSlug\u003e.jsonld`\u003c/span\u003e and \u003cspan class=\"token code-snippet code keyword\"\u003e`_payload/_default/\u0026#x3C;nodeSlug\u003e.jsonld`\u003c/span\u003e)\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e Other flows:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_ref/_working/\u0026#x3C;nodeSlug\u003e_ref.jsonld`\u003c/span\u003e\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_cfg-op/_working/\u0026#x3C;nodeSlug\u003e_cfg-op.jsonld`\u003c/span\u003e\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_cfg-inh/_working/\u0026#x3C;nodeSlug\u003e_cfg-inh.jsonld`\u003c/span\u003e\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta`\u003c/span\u003e:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e For \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003ethis task\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e, \u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e \u003cspan class=\"token bold\"\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003cspan class=\"token content\"\u003edoes not\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e**\u003c/span\u003e\u003c/span\u003e write any JSON-LD inside \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta`\u003c/span\u003e at all.\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta/_default/`\u003c/span\u003e is created as an empty directory; snapshots will be created by weaves later.\n\nNo \u003cspan class=\"token code-snippet code keyword\"\u003e`_meta/_working`\u003c/span\u003e directory.\n\n\u003cspan class=\"token title important\"\u003e\u003cspan class=\"token punctuation\"\u003e###\u003c/span\u003e 4. RdfSource and parsing semantics (must keep)\u003c/span\u003e\n\nContinue to implement/extend the previously agreed model:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`RdfSource`\u003c/span\u003e discriminated union:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`kind: 'file' | 'url' | 'inline'`\u003c/span\u003e with \u003cspan class=\"token code-snippet code keyword\"\u003e`syntax`\u003c/span\u003e hint.\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e Parsing behavior:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e For \u003cspan class=\"token code-snippet code keyword\"\u003e`kind: 'file'`\u003c/span\u003e:\n    \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`documentIri = file:///absolute/path/to/file`\u003c/span\u003e\n    \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e parse with \u003cspan class=\"token code-snippet code keyword\"\u003e`baseIri = documentIri`\u003c/span\u003e.\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e For \u003cspan class=\"token code-snippet code keyword\"\u003e`kind: 'url'`\u003c/span\u003e:\n    \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`documentIri = url`\u003c/span\u003e.\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e For \u003cspan class=\"token code-snippet code keyword\"\u003e`kind: 'inline'`\u003c/span\u003e:\n    \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e use a synthetic \u003cspan class=\"token code-snippet code keyword\"\u003e`file:///virtual/...`\u003c/span\u003e base (document in comments).\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e Mesh-native JSON-LD serialization:\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e no \u003cspan class=\"token code-snippet code keyword\"\u003e`@base`\u003c/span\u003e in context,\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e local IRIs relative to the chosen target base,\n  \u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e external IRIs absolute.\n\n\u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e must use \u003cspan class=\"token code-snippet code keyword\"\u003e`RdfSource`\u003c/span\u003e + debasing logic to populate \u003cspan class=\"token code-snippet code keyword\"\u003e`_working`\u003c/span\u003e distributions when inputs are provided.\n\n\u003cspan class=\"token title important\"\u003e\u003cspan class=\"token punctuation\"\u003e###\u003c/span\u003e 5. Provenance defaults: only via operational config\u003c/span\u003e\n\nRemove or ignore \u003cspan class=\"token code-snippet code keyword\"\u003e`ProvenanceBundleInput`\u003c/span\u003e in \u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e:\n\n\u003cspan class=\"token list punctuation\"\u003e-\u003c/span\u003e \u003cspan class=\"token code-snippet code keyword\"\u003e`createNode`\u003c/span\u003e options should look like:\n\n  ```ts\n  export interface CreateNodeOptions {\n    payloadDataset?: RdfSource;\n    referenceDataset?: RdfSource;\n    operationalConfig?: RdfSource;\n    inheritableConfig?: RdfSource;\n\n\u003cspan class=\"token code keyword\"\u003e    allowNonEmpty?: boolean;\u003c/span\u003e\n\n\u003cspan class=\"token code keyword\"\u003e    // Optional: node README content or path (see below)\n    readme?: string;      // inline markdown\n    readmePath?: string;  // file path for markdown\u003c/span\u003e\n  }\n\u003c/code\u003e\u003c/pre\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eIf \u003ccode\u003eoperationalConfig\u003c/code\u003e is provided:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eParse it as RDF via \u003ccode\u003eRdfSource\u003c/code\u003e and write \u003ccode\u003e_cfg-op/_working/\u0026#x3C;nodeSlug\u003e_cfg-op.jsonld\u003c/code\u003e in mesh-native form.\u003c/li\u003e\n\u003cli\u003eThis config MAY contain “provenance defaults” (rightsHolder, license, default agents, etc.), but \u003cstrong\u003eno actual weave events\u003c/strong\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eActual weave events and PROV activities will be created later by a generic weave operation consuming \u003ccode\u003e_cfg-op\u003c/code\u003e, \u003ccode\u003e_working\u003c/code\u003e datasets, etc.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"6-readme-and-starter-kits\"\u003e6. README and starter kits\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#6-readme-and-starter-kits\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eFor this task, support at least:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eOptional README content for the node itself:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ereadme\u003c/code\u003e (inline markdown) or \u003ccode\u003ereadmePath\u003c/code\u003e (file).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eDo \u003cstrong\u003enot\u003c/strong\u003e treat README as RDF; it’s normal content to be integrated into the node’s resource page (index.html).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eYou do \u003cem\u003enot\u003c/em\u003e need to implement zipped starter kits now; just keep the architecture flexible enough that \u003ccode\u003ecreateNode\u003c/code\u003e could later accept a “starter node bundle” and unpack it before applying additional config.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"resource-pages-indexhtml-behavior\"\u003eResource pages (index.html) behavior\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#resource-pages-indexhtml-behavior\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eWe want dereferenceability even before the first weave.\u003c/p\u003e\n\u003ch3 id=\"7-indexhtml-generation\"\u003e7. index.html generation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#7-indexhtml-generation\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003ecreateNode\u003c/code\u003e should generate basic \u003ccode\u003eindex.html\u003c/code\u003e files using a “platform default” template for:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eThe node root folder:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;nodePath\u003e/index.html\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eEach created flow directory:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;nodePath\u003e/_meta/index.html\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;nodePath\u003e/_payload/index.html\u003c/code\u003e (if created)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;nodePath\u003e/_ref/index.html\u003c/code\u003e (if created)\u003c/li\u003e\n\u003cli\u003eetc.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOptionally, each shot directory created at this stage:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;nodePath\u003e/_payload/_working/index.html\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e\u0026#x3C;nodePath\u003e/_cfg-op/_working/index.html\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eetc.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eTemplate requirements (minimal for now):\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003eNode \u003ccode\u003eindex.html\u003c/code\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMentions the node slug.\u003c/li\u003e\n\u003cli\u003eLinks to any existing flow directories as “NamingResources” / “FileResources” (no need for full ontology terms, just human-readable for now).\u003c/li\u003e\n\u003cli\u003eOptionally renders README content if provided (simple markdown → HTML is enough; can be naive).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eFlow \u003ccode\u003eindex.html\u003c/code\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eIdentifies the flow by slug (\u003ccode\u003e_payload\u003c/code\u003e, \u003ccode\u003e_ref\u003c/code\u003e, \u003ccode\u003e_cfg-op\u003c/code\u003e, etc.).\u003c/li\u003e\n\u003cli\u003eLinks to any \u003ccode\u003e_working\u003c/code\u003e distributions present (plain file links).\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThese templates can be simple functions or static HTML skeletons with minimal logic; the goal is just to ensure:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eevery directory is dereferenceable over HTTP,\u003c/li\u003e\n\u003cli\u003ethere’s enough structure that future weaves can build richer resource pages without breaking anything.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"what-needs-to-be-changed-vs-the-original-architecture-plan\"\u003eWhat needs to be changed vs the original architecture plan\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#what-needs-to-be-changed-vs-the-original-architecture-plan\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eWhen you implement this task, please:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRemove\u003c/strong\u003e snapshot generation from \u003ccode\u003ecreateNode\u003c/code\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNo \u003ccode\u003e_meta/v1\u003c/code\u003e, no \u003ccode\u003e_meta/_default\u003c/code\u003e distributions.\u003c/li\u003e\n\u003cli\u003eNo \u003ccode\u003ev1\u003c/code\u003e snapshots for \u003ccode\u003e_payload\u003c/code\u003e, \u003ccode\u003e_ref\u003c/code\u003e, \u003ccode\u003e_cfg-*\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eEnsure \u003ccode\u003e_meta\u003c/code\u003e is mandatory\u003c/strong\u003e, but only the directory and \u003ccode\u003e_default/\u003c/code\u003e subdir exist; no RDF.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eAdd \u003ccode\u003e_working\u003c/code\u003e shots\u003c/strong\u003e for flows where inputs are provided, using the naming rules above.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eDrop \u003ccode\u003eProvenanceBundleInput\u003c/code\u003e\u003c/strong\u003e from \u003ccode\u003ecreateNode\u003c/code\u003e; provenance defaults belong in \u003ccode\u003e_cfg-op/_working\u003c/code\u003e.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eAdd support for optional Node README\u003c/strong\u003e (inline or from file) at \u003ccode\u003ecreateNode\u003c/code\u003e time, store it as nodename/README.md\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eGenerate default \u003ccode\u003eindex.html\u003c/code\u003e\u003c/strong\u003e in node root (using README.md if present, and linking to created flow and FlowShot dirs).\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eYou can either refactor the existing \u003ccode\u003ecreateNode\u003c/code\u003e implementation/plan or restart it with these rules; given the amount of change, a \u003cstrong\u003esurgical refactor\u003c/strong\u003e is probably reasonable:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eKeep file locations, error types, and basic directory scaffolding logic.\u003c/li\u003e\n\u003cli\u003eRemove snapshot-writing logic and provenance bundles.\u003c/li\u003e\n\u003cli\u003eInsert \u003ccode\u003e_working\u003c/code\u003e shot writing + \u003ccode\u003eindex.html\u003c/code\u003e generation.\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2 id=\"success-criteria\"\u003eSuccess criteria\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#success-criteria\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThis task is complete when:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003ecreateNode\u003c/code\u003e:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCreates \u003ccode\u003e_meta/_default/\u003c/code\u003e as an empty directory.\u003c/li\u003e\n\u003cli\u003eCreates other flow dirs only as needed.\u003c/li\u003e\n\u003cli\u003eWrites \u003ccode\u003e_working\u003c/code\u003e distributions (mesh-native JSON-LD) for any flows where \u003ccode\u003eRdfSource\u003c/code\u003e inputs are provided.\u003c/li\u003e\n\u003cli\u003eDoes not write any snapshots (\u003ccode\u003ev1\u003c/code\u003e, \u003ccode\u003e_default\u003c/code\u003e distributions) or metadata RDF.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOptional \u003ccode\u003eoperationalConfig\u003c/code\u003e is written to \u003ccode\u003e_cfg-op/_working/\u0026#x3C;nodeSlug\u003e_cfg-op.jsonld\u003c/code\u003e and not used to generate any PROV events yet.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eOptional README is accepted and integrated into the node’s \u003ccode\u003eindex.html\u003c/code\u003e page.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003ccode\u003eindex.html\u003c/code\u003e exists in:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003enode root,\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e_meta/\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003eeach non-empty flow dir,\u003c/li\u003e\n\u003cli\u003eand each \u003ccode\u003e_working\u003c/code\u003e shot dir created by \u003ccode\u003ecreateNode\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003eAll affected tests are updated or added to reflect:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003e_meta\u003c/code\u003e is mandatory but RDF-free after \u003ccode\u003ecreateNode\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003eno snapshots exist after \u003ccode\u003ecreateNode\u003c/code\u003e,\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e_working\u003c/code\u003e distributions appear correctly when inputs are provided,\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eindex.html\u003c/code\u003e gets created in the expected locations.\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cpre\u003e\u003ccode\u003e\u003c/code\u003e\u003c/pre\u003e","noteIndex":{"id":"voy7zrf0f6bs86m02uadhaf","title":"Semantic Flow Documentation","desc":"","updated":1756155165637,"created":1755709990079,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"documentation","selfContained":false,"name":"sflo"},"contentHash":"98cbbdb73a40d62308166fed9c2f594f","links":[{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"now","position":{"start":{"line":4,"column":1,"offset":107},"end":{"line":4,"column":8,"offset":114},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"now"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"todo","position":{"start":{"line":4,"column":11,"offset":117},"end":{"line":4,"column":19,"offset":125},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"todo"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"principle","position":{"start":{"line":4,"column":22,"offset":128},"end":{"line":4,"column":35,"offset":141},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"principle"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"dev.contributor.djradon.dev-log","position":{"start":{"line":4,"column":38,"offset":144},"end":{"line":4,"column":73,"offset":179},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"dev.contributor.djradon.dev-log"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"concept.single-mesh-repo","position":{"start":{"line":10,"column":1,"offset":498},"end":{"line":10,"column":29,"offset":526},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"concept.single-mesh-repo"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"concept.mesh","position":{"start":{"line":10,"column":47,"offset":544},"end":{"line":10,"column":63,"offset":560},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"concept.mesh"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"concept.semantic-flow-site","position":{"start":{"line":10,"column":112,"offset":609},"end":{"line":10,"column":142,"offset":639},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"concept.semantic-flow-site"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"feature","position":{"start":{"line":23,"column":7,"offset":1053},"end":{"line":23,"column":18,"offset":1064},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"feature"}}],"anchors":{"what-is-semantic-flow":{"type":"header","text":"What Is Semantic Flow?","value":"what-is-semantic-flow","line":12,"column":0,"depth":2},"benefits":{"type":"header","text":"Benefits","value":"benefits","line":18,"column":0,"depth":2},"features":{"type":"header","text":"Features","value":"features","line":25,"column":0,"depth":2}},"children":["completed-tasks","p0vd6xnshcxw14ztkglxyxn","qa6hqxy4tknnmutvq13onaq","sfgrcjcttxz7b3qov7efg3f","facets","faq000","ggle3sz2jv3vf53t9qplrzo","mesh-file","mesh-folder","guides","mesh-resource","yxn5rsqsv2gq4s6wbnxsjsj","l9g8eki3dtir51o4jagac5a","28q7fh05bs691llgv7htxnw","products","tkw34hrqxficesa0y2r62s0","tasks","xqjr13fyons9goxv8rjrskj","use-cases","8wh7p4aps8humop7vqymk3n"],"parent":null,"data":{},"body":"\n**Dereferenceable, versioned semantic meshes** will be the foundation for a new era of knowledge graphs.\n\n[[now]] | [[todo]] | [[principle]] | [[dev.contributor.djradon.dev-log]]\n\n## What Is Semantic Flow?\n\n**Semantic Flow** is a framework for managing and publishing resource identifiers, knowledge graphs and other semantic data by leveraging GitHub, Gitlab, and other free static hosting services. It enables a **dereferenceable Semantic Web** where every HTTP IRI returns meaningful content.\n\n[[concept.single-mesh-repo]] provide storage, [[concept.mesh]] provide resource management and publishing, and [[concept.semantic-flow-site]] support data discovery and explainability.\n\n## Benefits\n\n- own your own self-describing data and data schemas\n- complete version history when you want it\n- reliable persistence\n- truly FAIR (Findable, Accessible, Interoperable, and Reusable)\n\n## Features\n\n- seamlessly integrate other data sources anywhere in your mesh\n- generate and customize mini-sites or single-page applications for nodes in your mesh\n- see [[feature]] for a list of planned features\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"none","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"selection","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"documentation","selfContained":false,"name":"sflo"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Semantic Flow Docs","description":"A dendron-based wiki for sflo"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://semantic-flow.github.io/sflo","assetsPrefix":"/sflo","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"k2apr2q5ibovesxgkhhgkmp"},"buildId":"stable-build-id","assetPrefix":"/sflo","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>