<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/sflo/favicon.ico"/><title>Architecture Plan - RdfSource &amp; createNode</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Detailed architecture and implementation plan for RdfSource abstraction and createNode operation"/><meta property="og:title" content="Architecture Plan - RdfSource &amp; createNode"/><meta property="og:description" content="Detailed architecture and implementation plan for RdfSource abstraction and createNode operation"/><meta property="og:url" content="https://semantic-flow.github.io/sflo/notes/architecture-plan-rdfsource-createnode/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="1/1/1970"/><meta property="article:modified_time" content="11/28/2025"/><link rel="canonical" href="https://semantic-flow.github.io/sflo/notes/architecture-plan-rdfsource-createnode/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/sflo/_next/static/css/16a873435e51c1c5.css" as="style"/><link rel="stylesheet" href="/sflo/_next/static/css/16a873435e51c1c5.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/sflo/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/sflo/_next/static/chunks/webpack-ab072f314bee576a.js" defer=""></script><script src="/sflo/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/sflo/_next/static/chunks/main-e7d9c70dd8957f37.js" defer=""></script><script src="/sflo/_next/static/chunks/pages/_app-a6232c6cf10e06f7.js" defer=""></script><script src="/sflo/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/sflo/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/sflo/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/sflo/_next/static/stable-build-id/_buildManifest.js" defer=""></script><script src="/sflo/_next/static/stable-build-id/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="architecture-plan---rdfsource--createnode">Architecture Plan - RdfSource &#x26; createNode<a aria-hidden="true" class="anchor-heading icon-link" href="#architecture-plan---rdfsource--createnode"></a></h1>
<h1 id="architecture-plan-rdfsource-abstraction--createnode-operation">Architecture Plan: RdfSource Abstraction &#x26; createNode Operation<a aria-hidden="true" class="anchor-heading icon-link" href="#architecture-plan-rdfsource-abstraction--createnode-operation"></a></h1>
<h2 id="overview">Overview<a aria-hidden="true" class="anchor-heading icon-link" href="#overview"></a></h2>
<p>This document provides the architectural design for implementing:</p>
<ol>
<li><strong>RdfSource abstraction</strong> - A coherent model for RDF loading/serialization</li>
<li><strong>createNode operation</strong> - Core mesh node initialization using RdfSource</li>
</ol>
<h2 id="1-rdfsource-abstraction-design">1. RdfSource Abstraction Design<a aria-hidden="true" class="anchor-heading icon-link" href="#1-rdfsource-abstraction-design"></a></h2>
<h3 id="11-core-principles">1.1 Core Principles<a aria-hidden="true" class="anchor-heading icon-link" href="#11-core-principles"></a></h3>
<ul>
<li><strong>Explicit base handling</strong>: Always require a base IRI for parsing</li>
<li><strong>Mesh-native output</strong>: Serialize with relative IRIs, no <code>@base</code></li>
<li><strong>Format-agnostic</strong>: Support JSON-LD (primary) and Turtle/TriG (future)</li>
<li><strong>Testable &#x26; composable</strong>: Small, focused functions that compose well</li>
</ul>
<h3 id="12-type-definitions">1.2 Type Definitions<a aria-hidden="true" class="anchor-heading icon-link" href="#12-type-definitions"></a></h3>
<p>Location: <a href="/sflo/../../shared/core/src/rdf/types.ts"><code>shared/core/src/rdf/types.ts</code></a></p>
<pre class="language-typescript"><code class="language-typescript"><span class="token doc-comment comment">/**
 * Source of RDF data - file path, URL, or in-memory content
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">RdfSourceInput</span></span> <span class="token operator">=</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">"file"</span><span class="token punctuation">;</span> path<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">"url"</span><span class="token punctuation">;</span> url<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span>
  <span class="token operator">|</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">"content"</span><span class="token punctuation">;</span> content<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> format<span class="token operator">:</span> <span class="token maybe-class-name">RdfFormat</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Supported RDF serialization formats
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">type</span> <span class="token class-name"><span class="token maybe-class-name">RdfFormat</span></span> <span class="token operator">=</span> <span class="token string">"jsonld"</span> <span class="token operator">|</span> <span class="token string">"turtle"</span> <span class="token operator">|</span> <span class="token string">"trig"</span> <span class="token operator">|</span> <span class="token string">"ntriples"</span> <span class="token operator">|</span> <span class="token string">"nquads"</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Options for parsing RDF
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">RdfParseOptions</span></span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/** Base IRI for resolving relative references (REQUIRED) */</span>
  baseIri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token doc-comment comment">/** Expected format (auto-detect if not specified) */</span>
  format<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">RdfFormat</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Options for serializing RDF
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">RdfSerializeOptions</span></span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/** Output format */</span>
  format<span class="token operator">:</span> <span class="token maybe-class-name">RdfFormat</span><span class="token punctuation">;</span>
  <span class="token doc-comment comment">/** Whether to include @base in output (default: false for mesh-native) */</span>
  includeBase<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token doc-comment comment">/** Whether to pretty-print (default: true) */</span>
  prettyPrint<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Metadata about the RDF source
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">RdfSourceMetadata</span></span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/** Detected or provided base IRI */</span>
  baseIri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token doc-comment comment">/** Detected format */</span>
  format<span class="token operator">:</span> <span class="token maybe-class-name">RdfFormat</span><span class="token punctuation">;</span>
  <span class="token doc-comment comment">/** Original source location (file path or URL) */</span>
  sourceLocation<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Loaded RDF dataset with metadata
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">RdfDataset</span></span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/** The RDF quads (using @rdfjs/types) */</span>
  quads<span class="token operator">:</span> <span class="token maybe-class-name">Quad</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token doc-comment comment">/** Metadata about the source */</span>
  metadata<span class="token operator">:</span> <span class="token maybe-class-name">RdfSourceMetadata</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="13-core-functions">1.3 Core Functions<a aria-hidden="true" class="anchor-heading icon-link" href="#13-core-functions"></a></h3>
<p>Location: <a href="/sflo/../../shared/core/src/rdf/source.ts"><code>shared/core/src/rdf/source.ts</code></a></p>
<pre class="language-typescript"><code class="language-typescript"><span class="token doc-comment comment">/**
 * Parse RDF from a source into quads
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">source</span> - RDF source input
 * <span class="token keyword">@param</span> <span class="token parameter">options</span> - Parse options (baseIri REQUIRED)
 * <span class="token keyword">@returns</span> Loaded dataset with quads and metadata
 * 
 * See: concept.implied-rdf-base, concept.identifier.intramesh.relative
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">parseRdf</span><span class="token punctuation">(</span>
  source<span class="token operator">:</span> <span class="token maybe-class-name">RdfSourceInput</span><span class="token punctuation">,</span>
  options<span class="token operator">:</span> <span class="token maybe-class-name">RdfParseOptions</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">RdfDataset</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Serialize RDF quads to a string
 * 
 * Mesh-native mode (default):
 * - No @base in output
 * - Local IRIs become relative IRIs
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">dataset</span> - RDF dataset to serialize
 * <span class="token keyword">@param</span> <span class="token parameter">options</span> - Serialization options
 * <span class="token keyword">@returns</span> Serialized RDF string
 * 
 * See: concept.identifier.intramesh.relative
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">serializeRdf</span><span class="token punctuation">(</span>
  dataset<span class="token operator">:</span> <span class="token maybe-class-name">RdfDataset</span><span class="token punctuation">,</span>
  options<span class="token operator">:</span> <span class="token maybe-class-name">RdfSerializeOptions</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Compute file:/// base IRI from absolute file path
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">absolutePath</span> - Absolute filesystem path
 * <span class="token keyword">@returns</span> file:/// URL suitable as RDF base
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">filePathToBaseIri</span><span class="token punctuation">(</span>absolutePath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Extract base IRI from RDF content (if present)
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">content</span> - RDF content string
 * <span class="token keyword">@param</span> <span class="token parameter">format</span> - RDF format
 * <span class="token keyword">@returns</span> Detected base IRI or undefined
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">detectBaseIri</span><span class="token punctuation">(</span>
  content<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  format<span class="token operator">:</span> <span class="token maybe-class-name">RdfFormat</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword nil">undefined</span><span class="token operator">></span><span class="token punctuation">;</span>
</code></pre>
<h3 id="14-helper-functions">1.4 Helper Functions<a aria-hidden="true" class="anchor-heading icon-link" href="#14-helper-functions"></a></h3>
<p>Location: <a href="/sflo/../../shared/core/src/rdf/helpers.ts"><code>shared/core/src/rdf/helpers.ts</code></a></p>
<pre class="language-typescript"><code class="language-typescript"><span class="token doc-comment comment">/**
 * Make IRIs relative to a base
 * 
 * Used for creating mesh-native files from external datasets
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">quads</span> - RDF quads with absolute IRIs
 * <span class="token keyword">@param</span> <span class="token parameter">baseIri</span> - Base to make relative to
 * <span class="token keyword">@returns</span> Quads with relative IRIs where applicable
 * 
 * See: concept.debasing
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">makeIrisRelative</span><span class="token punctuation">(</span>
  quads<span class="token operator">:</span> <span class="token maybe-class-name">Quad</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  baseIri<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">Quad</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Detect RDF format from file extension or content
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">pathOrContent</span> - File path or content string
 * <span class="token keyword">@returns</span> Detected format
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">detectFormat</span><span class="token punctuation">(</span>pathOrContent<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">RdfFormat</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Validate that a base IRI is suitable for mesh use
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">baseIri</span> - IRI to validate
 * <span class="token keyword">@throws</span> if invalid
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">function</span> <span class="token function">validateMeshBaseIri</span><span class="token punctuation">(</span>baseIri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="15-implementation-notes">1.5 Implementation Notes<a aria-hidden="true" class="anchor-heading icon-link" href="#15-implementation-notes"></a></h3>
<ul>
<li>Use <code>@rdfjs/types</code> for Quad interface</li>
<li>Use <code>jsonld</code> library for JSON-LD parsing/serialization</li>
<li>Use <code>n3</code> library for Turtle/TriG parsing/serialization</li>
<li>Use <code>@rdfjs/data-model</code> for creating quads</li>
<li>Handle errors gracefully with custom error types</li>
<li>All functions are pure and stateless</li>
</ul>
<h3 id="16-testing-strategy">1.6 Testing Strategy<a aria-hidden="true" class="anchor-heading icon-link" href="#16-testing-strategy"></a></h3>
<p>Location: <a href="/sflo/../../shared/core/src/rdf/__tests__"><code>shared/core/src/rdf/__tests__/</code></a></p>
<p>Test files:</p>
<ul>
<li><code>source.test.ts</code> - Core parsing/serialization</li>
<li><code>helpers.test.ts</code> - Helper functions</li>
<li><code>integration.test.ts</code> - End-to-end workflows</li>
</ul>
<p>Test cases:</p>
<ul>
<li>Parse JSON-LD with explicit base</li>
<li>Parse Turtle with base declaration</li>
<li>Serialize mesh-native JSON-LD (no <a title="Private" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank" class="private">@base (Private)</a>, relative IRIs)</li>
<li>Round-trip: parse → serialize → parse</li>
<li>Error handling: missing base, invalid format</li>
<li>File path to base IRI conversion</li>
<li>Base IRI detection</li>
</ul>
<h2 id="2-createnode-operation-design">2. createNode Operation Design<a aria-hidden="true" class="anchor-heading icon-link" href="#2-createnode-operation-design"></a></h2>
<h3 id="21-core-function-signature">2.1 Core Function Signature<a aria-hidden="true" class="anchor-heading icon-link" href="#21-core-function-signature"></a></h3>
<p>Location: <a href="/sflo/../../shared/core/src/operations/create-node.ts"><code>shared/core/src/operations/create-node.ts</code></a></p>
<pre class="language-typescript"><code class="language-typescript"><span class="token doc-comment comment">/**
 * Options for creating a new mesh node
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">CreateNodeOptions</span></span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/** Path to payload dataset (optional) */</span>
  payloadDatasetPath<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Path to reference dataset (optional) */</span>
  referenceDatasetPath<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Path to operational config dataset (optional) */</span>
  operationalConfigPath<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Path to inheritable config dataset (optional) */</span>
  inheritableConfigPath<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Provenance information (optional) */</span>
  provenanceInput<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">ProvenanceBundleInput</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Allow creating in non-empty directory (default: false) */</span>
  allowNonEmpty<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Namespace root path for computing base IRIs */</span>
  namespaceRoot<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Provenance information for node creation
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">ProvenanceBundleInput</span></span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/** Primary agent IRI (human or system) */</span>
  primaryAgentIri<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Organization IRI (rights holder org) */</span>
  organizationIri<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Additional contributor IRIs */</span>
  contributorsIri<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Rights holder IRI */</span>
  rightsHolderIri<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** License IRI (e.g., CC BY-SA URL) */</span>
  licenseIri<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Result of node creation
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">interface</span> <span class="token class-name"><span class="token maybe-class-name">CreateNodeResult</span></span> <span class="token punctuation">{</span>
  <span class="token doc-comment comment">/** Absolute path to created node */</span>
  nodePath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Node slug (derived from folder name) */</span>
  nodeSlug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Base IRI for the node */</span>
  nodeBaseIri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  
  <span class="token doc-comment comment">/** Created flow paths */</span>
  flows<span class="token operator">:</span> <span class="token punctuation">{</span>
    meta<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    ref<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    payload<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    cfgOp<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    cfgInh<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token doc-comment comment">/**
 * Create a new mesh node
 * 
 * Steps:
 * 1. Validate path (not already a node, handle allowNonEmpty)
 * 2. Create node directory structure
 * 3. Create _node-handle/ stub
 * 4. Create _meta/ v1 and _default/ with minimal metadata
 * 5. Optionally import reference/payload/config datasets
 * 6. Return result summary
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">nodeTargetPath</span> - Path where node should be created
 * <span class="token keyword">@param</span> <span class="token parameter">options</span> - Creation options
 * <span class="token keyword">@returns</span> Creation result
 * <span class="token keyword">@throws</span> <span class="token punctuation">{</span>NodeAlreadyExistsError<span class="token punctuation">}</span> if node already initialized
 * <span class="token keyword">@throws</span> <span class="token punctuation">{</span>DirectoryNotEmptyError<span class="token punctuation">}</span> if directory not empty and !allowNonEmpty
 * 
 * See: task.2025-11-27-createNode, concept.weave-process
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createNode</span><span class="token punctuation">(</span>
  nodeTargetPath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  options<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">CreateNodeOptions</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token maybe-class-name">CreateNodeResult</span><span class="token operator">></span><span class="token punctuation">;</span>
</code></pre>
<h3 id="22-internal-functions">2.2 Internal Functions<a aria-hidden="true" class="anchor-heading icon-link" href="#22-internal-functions"></a></h3>
<pre class="language-typescript"><code class="language-typescript"><span class="token doc-comment comment">/**
 * Validate that path is suitable for node creation
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">validateNodePath</span><span class="token punctuation">(</span>
  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  allowNonEmpty<span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Create directory structure for a node
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createNodeScaffolding</span><span class="token punctuation">(</span>
  nodePath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  nodeSlug<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Generate minimal v1 metadata for a new node
 */</span>
<span class="token keyword">function</span> <span class="token function">generateNodeMetadata</span><span class="token punctuation">(</span>
  nodeSlug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  nodeBaseIri<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  provenance<span class="token operator">?</span><span class="token operator">:</span> <span class="token maybe-class-name">ProvenanceBundleInput</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token maybe-class-name">RdfDataset</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Import and normalize a dataset into a flow
 */</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">importDatasetToFlow</span><span class="token punctuation">(</span>
  sourcePath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  targetFlowPath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  nodeSlug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  flowSlug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  nodeBaseIri<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token known-class-name class-name">Promise</span><span class="token operator">&#x3C;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Derive node slug from folder name
 */</span>
<span class="token keyword">function</span> <span class="token function">deriveNodeSlug</span><span class="token punctuation">(</span>nodePath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Compute node base IRI from path and namespace root
 */</span>
<span class="token keyword">function</span> <span class="token function">computeNodeBaseIri</span><span class="token punctuation">(</span>
  nodePath<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  namespaceRoot<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="23-flow-slug-constants">2.3 Flow Slug Constants<a aria-hidden="true" class="anchor-heading icon-link" href="#23-flow-slug-constants"></a></h3>
<p>Location: <a href="/sflo/../../shared/core/src/constants/flows.ts"><code>shared/core/src/constants/flows.ts</code></a></p>
<pre class="language-typescript"><code class="language-typescript"><span class="token doc-comment comment">/**
 * Flow slug constants (from semantic-flow ontology)
 * 
 * See: ontology/semantic-flow/_payload-flow/_working/semantic-flow-ontology.jsonld
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token constant">FLOW_SLUGS</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">META</span><span class="token operator">:</span> <span class="token string">"_meta"</span><span class="token punctuation">,</span>
  <span class="token constant">REF</span><span class="token operator">:</span> <span class="token string">"_ref"</span><span class="token punctuation">,</span>
  <span class="token constant">PAYLOAD</span><span class="token operator">:</span> <span class="token string">"_payload"</span><span class="token punctuation">,</span>
  <span class="token constant">CFG_OP</span><span class="token operator">:</span> <span class="token string">"_cfg-op"</span><span class="token punctuation">,</span>
  <span class="token constant">CFG_INH</span><span class="token operator">:</span> <span class="token string">"_cfg-inh"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword module">as</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * Snapshot folder names
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token constant">SNAPSHOT_FOLDERS</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">WORKING</span><span class="token operator">:</span> <span class="token string">"_working"</span><span class="token punctuation">,</span>
  <span class="token constant">DEFAULT</span><span class="token operator">:</span> <span class="token string">"_default"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword module">as</span> <span class="token keyword">const</span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * System folder names
 */</span>
<span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token constant">SYSTEM_FOLDERS</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">HANDLE</span><span class="token operator">:</span> <span class="token string">"_node-handle"</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword module">as</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="24-filename-generation">2.4 Filename Generation<a aria-hidden="true" class="anchor-heading icon-link" href="#24-filename-generation"></a></h3>
<pre class="language-typescript"><code class="language-typescript"><span class="token doc-comment comment">/**
 * Generate distribution filename for a flow
 * 
 * Payload: &#x3C;nodeSlug>.jsonld
 * Others: &#x3C;nodeSlug>_&#x3C;flowSlug>.jsonld
 * 
 * <span class="token keyword">@param</span> <span class="token parameter">nodeSlug</span> - Node slug
 * <span class="token keyword">@param</span> <span class="token parameter">flowSlug</span> - Flow slug (undefined for payload)
 * <span class="token keyword">@returns</span> Filename
 */</span>
<span class="token keyword">function</span> <span class="token function">generateDistributionFilename</span><span class="token punctuation">(</span>
  nodeSlug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
  flowSlug<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>flowSlug <span class="token operator">||</span> flowSlug <span class="token operator">===</span> <span class="token constant">FLOW_SLUGS</span><span class="token punctuation">.</span><span class="token constant">PAYLOAD</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nodeSlug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.jsonld</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nodeSlug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>flowSlug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.jsonld</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<h3 id="25-metadata-generation-strategy">2.5 Metadata Generation Strategy<a aria-hidden="true" class="anchor-heading icon-link" href="#25-metadata-generation-strategy"></a></h3>
<p>The v1 metadata will include:</p>
<ol>
<li>
<p><strong>Node Description</strong></p>
<ul>
<li>Node IRI: <code>&#x3C;></code> (relative, resolves to node)</li>
<li>Type: Placeholder or inferred from flows</li>
<li>Label/description: Minimal stub</li>
</ul>
</li>
<li>
<p><strong>Flow Metadata</strong></p>
<ul>
<li>Meta flow IRI: <code>_meta/</code> (relative)</li>
<li>Flow type: <code>sflo:NodeMetadataFlow</code></li>
<li>Weave label: Initial (e.g., "2025-11-28_1112_00")</li>
<li>Sequence number: 1</li>
</ul>
</li>
<li>
<p><strong>Provenance (Minimal)</strong></p>
<ul>
<li>NodeCreation activity stub</li>
<li>Agent reference (if provided)</li>
<li>Rights/license (if provided)</li>
<li>No full DelegationChain yet</li>
</ul>
</li>
<li>
<p><strong>Relative IRIs</strong></p>
<ul>
<li>All local references use relative IRIs</li>
<li>External vocabularies use absolute IRIs</li>
<li>No <code>@base</code> in serialized output</li>
</ul>
</li>
</ol>
<p>Example metadata structure:</p>
<pre class="language-jsonld"><code class="language-jsonld">{
  "@context": {
    "sflo": "https://semantic-flow.github.io/ontology/semantic-flow/",
    "dcat": "http://www.w3.org/ns/dcat#",
    "dcterms": "http://purl.org/dc/terms/",
    "prov": "http://www.w3.org/ns/prov#"
  },
  "@graph": [
    {
      "@id": "",
      "@type": "sflo:BareNode",
      "dcterms:title": "Node Title"
    },
    {
      "@id": "_meta/",
      "@type": "sflo:NodeMetadataFlow",
      "sflo:weaveLabel": "2025-11-28_1112_00",
      "sflo:versioningState": { "@id": "sflo:VersioningState/versioned/" }
    },
    {
      "@id": "_meta/_default/",
      "@type": "sflo:DefaultShot",
      "sflo:sequenceNumber": 1,
      "prov:wasGeneratedBy": {
        "@id": "_meta/_default/#creation-activity"
      }
    }
  ]
}
</code></pre>
<h3 id="26-directory-structure-created">2.6 Directory Structure Created<a aria-hidden="true" class="anchor-heading icon-link" href="#26-directory-structure-created"></a></h3>
<pre><code>&#x3C;nodeTargetPath>/
├── _node-handle/
│   └── README.md          # Stub explaining the handle concept
├── _meta/
│   ├── v1/
│   │   └── &#x3C;slug>_meta.jsonld
│   └── _default/
│       └── &#x3C;slug>_meta.jsonld
[optional flows if datasets provided:]
├── _ref/
│   ├── v1/
│   │   └── &#x3C;slug>_ref.jsonld
│   └── _default/
│       └── &#x3C;slug>_ref.jsonld
├── _payload/
│   ├── v1/
│   │   └── &#x3C;slug>.jsonld
│   └── _default/
│       └── &#x3C;slug>.jsonld
├── _cfg-op/
│   ├── v1/
│   │   └── &#x3C;slug>_cfg-op.jsonld
│   └── _default/
│       └── &#x3C;slug>_cfg-op.jsonld
└── _cfg-inh/
    ├── v1/
    │   └── &#x3C;slug>_cfg-inh.jsonld
    └── _default/
        └── &#x3C;slug>_cfg-inh.jsonld
</code></pre>
<h3 id="27-error-handling">2.7 Error Handling<a aria-hidden="true" class="anchor-heading icon-link" href="#27-error-handling"></a></h3>
<p>Custom error types in <a href="/sflo/../../shared/core/src/errors/node-errors.ts"><code>shared/core/src/errors/node-errors.ts</code></a>:</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token known-class-name class-name">NodeAlreadyExistsError</span></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token known-class-name class-name">Error</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Node already exists at: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">=</span> <span class="token string">"NodeAlreadyExistsError"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token known-class-name class-name">DirectoryNotEmptyError</span></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token known-class-name class-name">Error</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Directory not empty: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. Use allowNonEmpty option to override.</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">=</span> <span class="token string">"DirectoryNotEmptyError"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword module">export</span> <span class="token keyword">class</span> <span class="token class-name"><span class="token known-class-name class-name">InvalidNodePathError</span></span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token known-class-name class-name">Error</span></span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> reason<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Invalid node path: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">. Reason: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>reason<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">=</span> <span class="token string">"InvalidNodePathError"</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="3-simple-node-runner">3. Simple Node Runner<a aria-hidden="true" class="anchor-heading icon-link" href="#3-simple-node-runner"></a></h2>
<p>Location: <a href="/sflo/../../scripts/create-node.ts"><code>scripts/create-node.ts</code></a></p>
<pre class="language-typescript"><code class="language-typescript"><span class="token hashbang comment">#!/usr/bin/env tsx</span>
<span class="token doc-comment comment">/**
 * Simple CLI runner for createNode operation
 * 
 * Usage:
 *   npx tsx scripts/create-node.ts &#x3C;nodePath> [--allow-non-empty]
 */</span>

<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> createNode <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"@semantic-flow/core"</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token punctuation">{</span> parseArgs <span class="token punctuation">}</span></span> <span class="token keyword module">from</span> <span class="token string">"node:util"</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> values<span class="token punctuation">,</span> positionals <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">parseArgs</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    options<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string-property property">"allow-non-empty"</span><span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">"boolean"</span><span class="token punctuation">,</span> <span class="token keyword module">default</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    allowPositionals<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>positionals<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"Usage: create-node &#x3C;nodePath> [--allow-non-empty]"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token method function property-access">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> nodePath <span class="token operator">=</span> positionals<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Creating node at: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>nodePath<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">createNode</span><span class="token punctuation">(</span>nodePath<span class="token punctuation">,</span> <span class="token punctuation">{</span>
      allowNonEmpty<span class="token operator">:</span> values<span class="token punctuation">[</span><span class="token string">"allow-non-empty"</span><span class="token punctuation">]</span> <span class="token keyword module">as</span> <span class="token builtin">boolean</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">"\n✅ Node created successfully!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  Path: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span><span class="token property-access">nodePath</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  Slug: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span><span class="token property-access">nodeSlug</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  Base IRI: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span><span class="token property-access">nodeBaseIri</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">\nFlows created:</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  Metadata: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">meta</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">ref</span><span class="token punctuation">)</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  Reference: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">ref</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">payload</span><span class="token punctuation">)</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  Payload: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">payload</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">cfgOp</span><span class="token punctuation">)</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  Config (Op): </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">cfgOp</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">cfgInh</span><span class="token punctuation">)</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">  Config (Inh): </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token punctuation">.</span><span class="token property-access">flows</span><span class="token punctuation">.</span><span class="token property-access">cfgInh</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span><span class="token string">"\n❌ Error creating node:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">error</span><span class="token punctuation">(</span>error <span class="token keyword">instanceof</span> <span class="token class-name"><span class="token known-class-name class-name">Error</span></span> <span class="token operator">?</span> error<span class="token punctuation">.</span><span class="token property-access">message</span> <span class="token operator">:</span> <span class="token known-class-name class-name">String</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    process<span class="token punctuation">.</span><span class="token method function property-access">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="4-testing-strategy">4. Testing Strategy<a aria-hidden="true" class="anchor-heading icon-link" href="#4-testing-strategy"></a></h2>
<h3 id="41-rdfsource-tests">4.1 RdfSource Tests<a aria-hidden="true" class="anchor-heading icon-link" href="#41-rdfsource-tests"></a></h3>
<ul>
<li>Unit tests for each function</li>
<li>Format detection tests</li>
<li>Base IRI computation tests</li>
<li>Round-trip parse/serialize tests</li>
<li>Error handling tests</li>
</ul>
<h3 id="42-createnode-tests">4.2 createNode Tests<a aria-hidden="true" class="anchor-heading icon-link" href="#42-createnode-tests"></a></h3>
<p>Location: <a href="/sflo/../../shared/core/src/operations/__tests__/create-node.test.ts"><code>shared/core/src/operations/__tests__/create-node.test.ts</code></a></p>
<p>Test cases:</p>
<ol>
<li>Create node in empty directory</li>
<li>Fail on already-initialized node</li>
<li>Fail on non-empty directory without flag</li>
<li>Succeed on non-empty with allowNonEmpty</li>
<li>Create node with payload dataset</li>
<li>Create node with reference dataset</li>
<li>Create node with all optional datasets</li>
<li>Validate metadata content</li>
<li>Validate filename conventions</li>
<li>Validate directory structure</li>
</ol>
<h3 id="43-integration-tests">4.3 Integration Tests<a aria-hidden="true" class="anchor-heading icon-link" href="#43-integration-tests"></a></h3>
<p>End-to-end scenarios:</p>
<ol>
<li>Create node → read metadata → validate structure</li>
<li>Create node → import dataset → verify relative IRIs</li>
<li>Multiple nodes in hierarchy</li>
</ol>
<h2 id="5-documentation-updates">5. Documentation Updates<a aria-hidden="true" class="anchor-heading icon-link" href="#5-documentation-updates"></a></h2>
<h3 id="51-parsing-semantics-spec">5.1 Parsing Semantics Spec<a aria-hidden="true" class="anchor-heading icon-link" href="#51-parsing-semantics-spec"></a></h3>
<p>Update the following documentation files:</p>
<ol>
<li>
<p><strong><a href="/sflo/../../documentation/concept.identifier.intramesh.relative.md"><code>concept.identifier.intramesh.relative.md</code></a></strong></p>
<ul>
<li>Add section on parsing with base IRI</li>
<li>Add examples of relative IRI resolution</li>
</ul>
</li>
<li>
<p><strong><a href="/sflo/../../documentation/concept.iri.md"><code>concept.iri.md</code></a></strong></p>
<ul>
<li>Add section on base IRI computation</li>
<li>Add file:/// URL examples</li>
</ul>
</li>
<li>
<p><strong><a href="/sflo/../../documentation/concept.implied-rdf-base.md"><code>concept.implied-rdf-base.md</code></a></strong></p>
<ul>
<li>Add detailed parsing rules</li>
<li>Add serialization rules</li>
<li>Add examples</li>
</ul>
</li>
<li>
<p><strong><a href="/sflo/../../documentation/concept.debasing.md"><code>concept.debasing.md</code></a></strong></p>
<ul>
<li>Formalize the algorithm</li>
<li>Add step-by-step examples</li>
<li>Reference RdfSource functions</li>
</ul>
</li>
<li>
<p><strong>New file: <a href="/sflo/../../documentation/concept.rdf-source.md"><code>concept.rdf-source.md</code></a></strong></p>
<ul>
<li>Document the RdfSource abstraction</li>
<li>API reference</li>
<li>Usage examples</li>
</ul>
</li>
</ol>
<h2 id="6-dependencies-to-add">6. Dependencies to Add<a aria-hidden="true" class="anchor-heading icon-link" href="#6-dependencies-to-add"></a></h2>
<p>Update <a href="/sflo/../../shared/core/package.json"><code>shared/core/package.json</code></a>:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"dependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"@rdfjs/types"</span><span class="token operator">:</span> <span class="token string">"^1.1.0"</span><span class="token punctuation">,</span>
    <span class="token property">"@rdfjs/data-model"</span><span class="token operator">:</span> <span class="token string">"^2.0.0"</span><span class="token punctuation">,</span>
    <span class="token property">"jsonld"</span><span class="token operator">:</span> <span class="token string">"^8.3.2"</span><span class="token punctuation">,</span>
    <span class="token property">"n3"</span><span class="token operator">:</span> <span class="token string">"^1.17.2"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"devDependencies"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"@types/jsonld"</span><span class="token operator">:</span> <span class="token string">"^1.5.13"</span><span class="token punctuation">,</span>
    <span class="token property">"@types/n3"</span><span class="token operator">:</span> <span class="token string">"^1.16.4"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="7-implementation-order">7. Implementation Order<a aria-hidden="true" class="anchor-heading icon-link" href="#7-implementation-order"></a></h2>
<ol>
<li>
<p><strong>Phase 1: RdfSource Foundation</strong> (1-2 days)</p>
<ul>
<li>Install dependencies</li>
<li>Create type definitions</li>
<li>Implement core parsing/serialization</li>
<li>Implement helper functions</li>
<li>Write unit tests</li>
</ul>
</li>
<li>
<p><strong>Phase 2: createNode Core</strong> (2-3 days)</p>
<ul>
<li>Implement path validation</li>
<li>Implement scaffolding functions</li>
<li>Implement metadata generation</li>
<li>Implement optional dataset import</li>
<li>Write unit tests</li>
</ul>
</li>
<li>
<p><strong>Phase 3: Integration</strong> (1 day)</p>
<ul>
<li>Create runner script</li>
<li>Write integration tests</li>
<li>Manual testing</li>
</ul>
</li>
<li>
<p><strong>Phase 4: Documentation</strong> (1 day)</p>
<ul>
<li>Update concept docs</li>
<li>Add API documentation</li>
<li>Update task files</li>
</ul>
</li>
</ol>
<p><strong>Total estimated time: 5-7 days</strong></p>
<h2 id="8-future-enhancements-out-of-scope">8. Future Enhancements (Out of Scope)<a aria-hidden="true" class="anchor-heading icon-link" href="#8-future-enhancements-out-of-scope"></a></h2>
<p>These are explicitly <strong>not</strong> part of this task:</p>
<ul>
<li>Full debasing algorithm with IRI rewriting</li>
<li>Payload unpacking into child nodes</li>
<li>Config inheritance from parent nodes</li>
<li>Full PROV/DelegationChain modeling</li>
<li>SHACL validation</li>
<li>RDF store integration</li>
<li>CLI framework (Oclif) integration</li>
<li>Interactive mode with prompts</li>
</ul>
<h2 id="9-success-criteria">9. Success Criteria<a aria-hidden="true" class="anchor-heading icon-link" href="#9-success-criteria"></a></h2>
<p>The implementation is complete when:</p>
<ol>
<li>✅ RdfSource can parse JSON-LD and Turtle with explicit base</li>
<li>✅ RdfSource can serialize mesh-native JSON-LD (no <a title="Private" href="https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html" target="_blank" class="private">@base (Private)</a>, relative IRIs)</li>
<li>✅ createNode creates correct directory structure</li>
<li>✅ createNode generates valid v1 metadata</li>
<li>✅ createNode can import optional datasets</li>
<li>✅ All tests pass (unit + integration)</li>
<li>✅ Documentation is updated</li>
<li>✅ Simple runner script works</li>
<li>✅ Code follows project conventions</li>
<li>✅ Task files are updated with progress</li>
</ol>
<h2 id="references">References<a aria-hidden="true" class="anchor-heading icon-link" href="#references"></a></h2>
<ul>
<li><a href="/sflo/./task.2025-11-28-rdfsource-debasing-parsing.md">task.2025-11-28-rdfsource-debasing-parsing</a></li>
<li><a href="/sflo/./task.2025-11-27-createNode.md">task.2025-11-27-createNode</a></li>
<li><a href="/sflo/./concept.identifier.intramesh.relative.md">concept.identifier.intramesh.relative</a></li>
<li><a href="/sflo/./concept.implied-rdf-base.md">concept.implied-rdf-base</a></li>
<li><a href="/sflo/./concept.debasing.md">concept.debasing</a></li>
<li><a href="/sflo/./concept.weave-process.md">concept.weave-process</a></li>
<li><a href="/sflo/./dev.general-guidance.md">dev.general-guidance</a></li>
</ul>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/sflo/notes/ufnbtre0tn2pxq7dzjcgrz0">2025-11-27-createNode</a></li>
</ul></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#architecture-plan-rdfsource-abstraction--createnode-operation" title="Architecture Plan: RdfSource Abstraction &amp; createNode Operation">Architecture Plan: RdfSource Abstraction &amp; createNode Operation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#overview" title="Overview">Overview</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#1-rdfsource-abstraction-design" title="1. RdfSource Abstraction Design">1. RdfSource Abstraction Design</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#11-core-principles" title="1.1 Core Principles">1.1 Core Principles</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#12-type-definitions" title="1.2 Type Definitions">1.2 Type Definitions</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#13-core-functions" title="1.3 Core Functions">1.3 Core Functions</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#14-helper-functions" title="1.4 Helper Functions">1.4 Helper Functions</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#15-implementation-notes" title="1.5 Implementation Notes">1.5 Implementation Notes</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#16-testing-strategy" title="1.6 Testing Strategy">1.6 Testing Strategy</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#2-createnode-operation-design" title="2. createNode Operation Design">2. createNode Operation Design</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#21-core-function-signature" title="2.1 Core Function Signature">2.1 Core Function Signature</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#22-internal-functions" title="2.2 Internal Functions">2.2 Internal Functions</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#23-flow-slug-constants" title="2.3 Flow Slug Constants">2.3 Flow Slug Constants</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#24-filename-generation" title="2.4 Filename Generation">2.4 Filename Generation</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#25-metadata-generation-strategy" title="2.5 Metadata Generation Strategy">2.5 Metadata Generation Strategy</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#26-directory-structure-created" title="2.6 Directory Structure Created">2.6 Directory Structure Created</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#27-error-handling" title="2.7 Error Handling">2.7 Error Handling</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#3-simple-node-runner" title="3. Simple Node Runner">3. Simple Node Runner</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#4-testing-strategy" title="4. Testing Strategy">4. Testing Strategy</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#41-rdfsource-tests" title="4.1 RdfSource Tests">4.1 RdfSource Tests</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#42-createnode-tests" title="4.2 createNode Tests">4.2 createNode Tests</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#43-integration-tests" title="4.3 Integration Tests">4.3 Integration Tests</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#5-documentation-updates" title="5. Documentation Updates">5. Documentation Updates</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#51-parsing-semantics-spec" title="5.1 Parsing Semantics Spec">5.1 Parsing Semantics Spec</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#6-dependencies-to-add" title="6. Dependencies to Add">6. Dependencies to Add</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#7-implementation-order" title="7. Implementation Order">7. Implementation Order</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#8-future-enhancements-out-of-scope" title="8. Future Enhancements (Out of Scope)">8. Future Enhancements (Out of Scope)</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#9-success-criteria" title="9. Success Criteria">9. Success Criteria</a></div><div class="ant-anchor-link"><a class="ant-anchor-link-title" href="#references" title="References">References</a></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"architecture-plan-rdfsource-createnode","title":"Architecture Plan - RdfSource \u0026 createNode","desc":"Detailed architecture and implementation plan for RdfSource abstraction and createNode operation","created":"2025-11-28T00:00:00.000Z","custom":{},"fname":"task.2025-11-28-architecture-plan","type":"note","vault":{"fsPath":"documentation","selfContained":false,"name":"sflo"},"contentHash":"4d223fd3a3f78bc1857ff4de43d109ea","updated":1764349923593,"links":[{"type":"wiki","from":{"fname":"task.2025-11-28-architecture-plan","id":"architecture-plan-rdfsource-createnode","vaultName":"sflo"},"value":"user.base","alias":"@base","position":{"start":{"line":199,"column":37,"offset":5147},"end":{"line":199,"column":42,"offset":5152},"indent":[]},"xvault":false,"to":{"fname":"user.base"}},{"type":"wiki","from":{"fname":"task.2025-11-28-architecture-plan","id":"architecture-plan-rdfsource-createnode","vaultName":"sflo"},"value":"user.base","alias":"@base","position":{"start":{"line":723,"column":54,"offset":18060},"end":{"line":723,"column":59,"offset":18065},"indent":[]},"xvault":false,"to":{"fname":"user.base"}},{"from":{"fname":"task.2025-11-27-createNode","id":"ufnbtre0tn2pxq7dzjcgrz0","vaultName":"sflo"},"type":"backlink","position":{"start":{"line":18,"column":35,"offset":652},"end":{"line":18,"column":72,"offset":689},"indent":[]},"value":"task.2025-11-28-architecture-plan"}],"anchors":{"architecture-plan-rdfsource-abstraction--createnode-operation":{"type":"header","text":"Architecture Plan: RdfSource Abstraction \u0026 createNode Operation","value":"architecture-plan-rdfsource-abstraction--createnode-operation","line":10,"column":0,"depth":1},"overview":{"type":"header","text":"Overview","value":"overview","line":12,"column":0,"depth":2},"1-rdfsource-abstraction-design":{"type":"header","text":"1. RdfSource Abstraction Design","value":"1-rdfsource-abstraction-design","line":18,"column":0,"depth":2},"11-core-principles":{"type":"header","text":"1.1 Core Principles","value":"11-core-principles","line":20,"column":0,"depth":3},"12-type-definitions":{"type":"header","text":"1.2 Type Definitions","value":"12-type-definitions","line":27,"column":0,"depth":3},"13-core-functions":{"type":"header","text":"1.3 Core Functions","value":"13-core-functions","line":90,"column":0,"depth":3},"14-helper-functions":{"type":"header","text":"1.4 Helper Functions","value":"14-helper-functions","line":148,"column":0,"depth":3},"15-implementation-notes":{"type":"header","text":"1.5 Implementation Notes","value":"15-implementation-notes","line":186,"column":0,"depth":3},"16-testing-strategy":{"type":"header","text":"1.6 Testing Strategy","value":"16-testing-strategy","line":195,"column":0,"depth":3},"2-createnode-operation-design":{"type":"header","text":"2. createNode Operation Design","value":"2-createnode-operation-design","line":213,"column":0,"depth":2},"21-core-function-signature":{"type":"header","text":"2.1 Core Function Signature","value":"21-core-function-signature","line":215,"column":0,"depth":3},"22-internal-functions":{"type":"header","text":"2.2 Internal Functions","value":"22-internal-functions","line":314,"column":0,"depth":3},"23-flow-slug-constants":{"type":"header","text":"2.3 Flow Slug Constants","value":"23-flow-slug-constants","line":367,"column":0,"depth":3},"24-filename-generation":{"type":"header","text":"2.4 Filename Generation","value":"24-filename-generation","line":401,"column":0,"depth":3},"25-metadata-generation-strategy":{"type":"header","text":"2.5 Metadata Generation Strategy","value":"25-metadata-generation-strategy","line":425,"column":0,"depth":3},"26-directory-structure-created":{"type":"header","text":"2.6 Directory Structure Created","value":"26-directory-structure-created","line":484,"column":0,"depth":3},"27-error-handling":{"type":"header","text":"2.7 Error Handling","value":"27-error-handling","line":518,"column":0,"depth":3},"3-simple-node-runner":{"type":"header","text":"3. Simple Node Runner","value":"3-simple-node-runner","line":545,"column":0,"depth":2},"4-testing-strategy":{"type":"header","text":"4. Testing Strategy","value":"4-testing-strategy","line":604,"column":0,"depth":2},"41-rdfsource-tests":{"type":"header","text":"4.1 RdfSource Tests","value":"41-rdfsource-tests","line":606,"column":0,"depth":3},"42-createnode-tests":{"type":"header","text":"4.2 createNode Tests","value":"42-createnode-tests","line":614,"column":0,"depth":3},"43-integration-tests":{"type":"header","text":"4.3 Integration Tests","value":"43-integration-tests","line":630,"column":0,"depth":3},"5-documentation-updates":{"type":"header","text":"5. Documentation Updates","value":"5-documentation-updates","line":637,"column":0,"depth":2},"51-parsing-semantics-spec":{"type":"header","text":"5.1 Parsing Semantics Spec","value":"51-parsing-semantics-spec","line":639,"column":0,"depth":3},"6-dependencies-to-add":{"type":"header","text":"6. Dependencies to Add","value":"6-dependencies-to-add","line":666,"column":0,"depth":2},"7-implementation-order":{"type":"header","text":"7. Implementation Order","value":"7-implementation-order","line":685,"column":0,"depth":2},"8-future-enhancements-out-of-scope":{"type":"header","text":"8. Future Enhancements (Out of Scope)","value":"8-future-enhancements-out-of-scope","line":713,"column":0,"depth":2},"9-success-criteria":{"type":"header","text":"9. Success Criteria","value":"9-success-criteria","line":726,"column":0,"depth":2},"references":{"type":"header","text":"References","value":"references","line":741,"column":0,"depth":2}},"children":[],"parent":"tasks","data":{},"schema":{"schemaId":"task","moduleId":"task"}},"body":"\u003ch1 id=\"architecture-plan---rdfsource--createnode\"\u003eArchitecture Plan - RdfSource \u0026#x26; createNode\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#architecture-plan---rdfsource--createnode\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch1 id=\"architecture-plan-rdfsource-abstraction--createnode-operation\"\u003eArchitecture Plan: RdfSource Abstraction \u0026#x26; createNode Operation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#architecture-plan-rdfsource-abstraction--createnode-operation\"\u003e\u003c/a\u003e\u003c/h1\u003e\n\u003ch2 id=\"overview\"\u003eOverview\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#overview\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThis document provides the architectural design for implementing:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\u003cstrong\u003eRdfSource abstraction\u003c/strong\u003e - A coherent model for RDF loading/serialization\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ecreateNode operation\u003c/strong\u003e - Core mesh node initialization using RdfSource\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"1-rdfsource-abstraction-design\"\u003e1. RdfSource Abstraction Design\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#1-rdfsource-abstraction-design\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"11-core-principles\"\u003e1.1 Core Principles\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#11-core-principles\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eExplicit base handling\u003c/strong\u003e: Always require a base IRI for parsing\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eMesh-native output\u003c/strong\u003e: Serialize with relative IRIs, no \u003ccode\u003e@base\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eFormat-agnostic\u003c/strong\u003e: Support JSON-LD (primary) and Turtle/TriG (future)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eTestable \u0026#x26; composable\u003c/strong\u003e: Small, focused functions that compose well\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"12-type-definitions\"\u003e1.2 Type Definitions\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#12-type-definitions\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLocation: \u003ca href=\"/sflo/../../shared/core/src/rdf/types.ts\"\u003e\u003ccode\u003eshared/core/src/rdf/types.ts\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Source of RDF data - file path, URL, or in-memory content\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eRdfSourceInput\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\n  \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e type\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"file\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e path\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e type\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"url\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e url\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e type\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"content\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e content\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e format\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfFormat\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Supported RDF serialization formats\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003etype\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eRdfFormat\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"jsonld\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"turtle\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"trig\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"ntriples\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"nquads\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Options for parsing RDF\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eRdfParseOptions\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Base IRI for resolving relative references (REQUIRED) */\u003c/span\u003e\n  baseIri\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Expected format (auto-detect if not specified) */\u003c/span\u003e\n  format\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfFormat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Options for serializing RDF\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eRdfSerializeOptions\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Output format */\u003c/span\u003e\n  format\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfFormat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Whether to include @base in output (default: false for mesh-native) */\u003c/span\u003e\n  includeBase\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Whether to pretty-print (default: true) */\u003c/span\u003e\n  prettyPrint\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Metadata about the RDF source\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eRdfSourceMetadata\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Detected or provided base IRI */\u003c/span\u003e\n  baseIri\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Detected format */\u003c/span\u003e\n  format\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfFormat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Original source location (file path or URL) */\u003c/span\u003e\n  sourceLocation\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Loaded RDF dataset with metadata\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eRdfDataset\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** The RDF quads (using @rdfjs/types) */\u003c/span\u003e\n  quads\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eQuad\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Metadata about the source */\u003c/span\u003e\n  metadata\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfSourceMetadata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"13-core-functions\"\u003e1.3 Core Functions\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#13-core-functions\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLocation: \u003ca href=\"/sflo/../../shared/core/src/rdf/source.ts\"\u003e\u003ccode\u003eshared/core/src/rdf/source.ts\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Parse RDF from a source into quads\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003esource\u003c/span\u003e - RDF source input\n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003eoptions\u003c/span\u003e - Parse options (baseIri REQUIRED)\n * \u003cspan class=\"token keyword\"\u003e@returns\u003c/span\u003e Loaded dataset with quads and metadata\n * \n * See: concept.implied-rdf-base, concept.identifier.intramesh.relative\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eparseRdf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  source\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfSourceInput\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  options\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfParseOptions\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eRdfDataset\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Serialize RDF quads to a string\n * \n * Mesh-native mode (default):\n * - No @base in output\n * - Local IRIs become relative IRIs\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003edataset\u003c/span\u003e - RDF dataset to serialize\n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003eoptions\u003c/span\u003e - Serialization options\n * \u003cspan class=\"token keyword\"\u003e@returns\u003c/span\u003e Serialized RDF string\n * \n * See: concept.identifier.intramesh.relative\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eserializeRdf\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  dataset\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfDataset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  options\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfSerializeOptions\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Compute file:/// base IRI from absolute file path\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003eabsolutePath\u003c/span\u003e - Absolute filesystem path\n * \u003cspan class=\"token keyword\"\u003e@returns\u003c/span\u003e file:/// URL suitable as RDF base\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003efilePathToBaseIri\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eabsolutePath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Extract base IRI from RDF content (if present)\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003econtent\u003c/span\u003e - RDF content string\n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003eformat\u003c/span\u003e - RDF format\n * \u003cspan class=\"token keyword\"\u003e@returns\u003c/span\u003e Detected base IRI or undefined\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003edetectBaseIri\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  content\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  format\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfFormat\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token keyword nil\"\u003eundefined\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"14-helper-functions\"\u003e1.4 Helper Functions\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#14-helper-functions\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLocation: \u003ca href=\"/sflo/../../shared/core/src/rdf/helpers.ts\"\u003e\u003ccode\u003eshared/core/src/rdf/helpers.ts\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Make IRIs relative to a base\n * \n * Used for creating mesh-native files from external datasets\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003equads\u003c/span\u003e - RDF quads with absolute IRIs\n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003ebaseIri\u003c/span\u003e - Base to make relative to\n * \u003cspan class=\"token keyword\"\u003e@returns\u003c/span\u003e Quads with relative IRIs where applicable\n * \n * See: concept.debasing\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emakeIrisRelative\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  quads\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eQuad\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  baseIri\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eQuad\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Detect RDF format from file extension or content\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003epathOrContent\u003c/span\u003e - File path or content string\n * \u003cspan class=\"token keyword\"\u003e@returns\u003c/span\u003e Detected format\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003edetectFormat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epathOrContent\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfFormat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Validate that a base IRI is suitable for mesh use\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003ebaseIri\u003c/span\u003e - IRI to validate\n * \u003cspan class=\"token keyword\"\u003e@throws\u003c/span\u003e if invalid\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003evalidateMeshBaseIri\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ebaseIri\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"15-implementation-notes\"\u003e1.5 Implementation Notes\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#15-implementation-notes\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eUse \u003ccode\u003e@rdfjs/types\u003c/code\u003e for Quad interface\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003ejsonld\u003c/code\u003e library for JSON-LD parsing/serialization\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003en3\u003c/code\u003e library for Turtle/TriG parsing/serialization\u003c/li\u003e\n\u003cli\u003eUse \u003ccode\u003e@rdfjs/data-model\u003c/code\u003e for creating quads\u003c/li\u003e\n\u003cli\u003eHandle errors gracefully with custom error types\u003c/li\u003e\n\u003cli\u003eAll functions are pure and stateless\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"16-testing-strategy\"\u003e1.6 Testing Strategy\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#16-testing-strategy\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLocation: \u003ca href=\"/sflo/../../shared/core/src/rdf/__tests__\"\u003e\u003ccode\u003eshared/core/src/rdf/__tests__/\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eTest files:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003esource.test.ts\u003c/code\u003e - Core parsing/serialization\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehelpers.test.ts\u003c/code\u003e - Helper functions\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eintegration.test.ts\u003c/code\u003e - End-to-end workflows\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eTest cases:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eParse JSON-LD with explicit base\u003c/li\u003e\n\u003cli\u003eParse Turtle with base declaration\u003c/li\u003e\n\u003cli\u003eSerialize mesh-native JSON-LD (no \u003ca title=\"Private\" href=\"https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html\" target=\"_blank\" class=\"private\"\u003e@base (Private)\u003c/a\u003e, relative IRIs)\u003c/li\u003e\n\u003cli\u003eRound-trip: parse → serialize → parse\u003c/li\u003e\n\u003cli\u003eError handling: missing base, invalid format\u003c/li\u003e\n\u003cli\u003eFile path to base IRI conversion\u003c/li\u003e\n\u003cli\u003eBase IRI detection\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"2-createnode-operation-design\"\u003e2. createNode Operation Design\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#2-createnode-operation-design\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"21-core-function-signature\"\u003e2.1 Core Function Signature\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#21-core-function-signature\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLocation: \u003ca href=\"/sflo/../../shared/core/src/operations/create-node.ts\"\u003e\u003ccode\u003eshared/core/src/operations/create-node.ts\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Options for creating a new mesh node\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eCreateNodeOptions\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Path to payload dataset (optional) */\u003c/span\u003e\n  payloadDatasetPath\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Path to reference dataset (optional) */\u003c/span\u003e\n  referenceDatasetPath\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Path to operational config dataset (optional) */\u003c/span\u003e\n  operationalConfigPath\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Path to inheritable config dataset (optional) */\u003c/span\u003e\n  inheritableConfigPath\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Provenance information (optional) */\u003c/span\u003e\n  provenanceInput\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eProvenanceBundleInput\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Allow creating in non-empty directory (default: false) */\u003c/span\u003e\n  allowNonEmpty\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Namespace root path for computing base IRIs */\u003c/span\u003e\n  namespaceRoot\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Provenance information for node creation\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eProvenanceBundleInput\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Primary agent IRI (human or system) */\u003c/span\u003e\n  primaryAgentIri\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Organization IRI (rights holder org) */\u003c/span\u003e\n  organizationIri\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Additional contributor IRIs */\u003c/span\u003e\n  contributorsIri\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Rights holder IRI */\u003c/span\u003e\n  rightsHolderIri\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** License IRI (e.g., CC BY-SA URL) */\u003c/span\u003e\n  licenseIri\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Result of node creation\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einterface\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token maybe-class-name\"\u003eCreateNodeResult\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token doc-comment comment\"\u003e/** Absolute path to created node */\u003c/span\u003e\n  nodePath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Node slug (derived from folder name) */\u003c/span\u003e\n  nodeSlug\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Base IRI for the node */\u003c/span\u003e\n  nodeBaseIri\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \n  \u003cspan class=\"token doc-comment comment\"\u003e/** Created flow paths */\u003c/span\u003e\n  flows\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    meta\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    ref\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    payload\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    cfgOp\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    cfgInh\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Create a new mesh node\n * \n * Steps:\n * 1. Validate path (not already a node, handle allowNonEmpty)\n * 2. Create node directory structure\n * 3. Create _node-handle/ stub\n * 4. Create _meta/ v1 and _default/ with minimal metadata\n * 5. Optionally import reference/payload/config datasets\n * 6. Return result summary\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003enodeTargetPath\u003c/span\u003e - Path where node should be created\n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003eoptions\u003c/span\u003e - Creation options\n * \u003cspan class=\"token keyword\"\u003e@returns\u003c/span\u003e Creation result\n * \u003cspan class=\"token keyword\"\u003e@throws\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eNodeAlreadyExistsError\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e if node already initialized\n * \u003cspan class=\"token keyword\"\u003e@throws\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003eDirectoryNotEmptyError\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e if directory not empty and !allowNonEmpty\n * \n * See: task.2025-11-27-createNode, concept.weave-process\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateNode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  nodeTargetPath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  options\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eCreateNodeOptions\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token maybe-class-name\"\u003eCreateNodeResult\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"22-internal-functions\"\u003e2.2 Internal Functions\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#22-internal-functions\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Validate that path is suitable for node creation\n */\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003evalidateNodePath\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  path\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  allowNonEmpty\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Create directory structure for a node\n */\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateNodeScaffolding\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  nodePath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  nodeSlug\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Generate minimal v1 metadata for a new node\n */\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003egenerateNodeMetadata\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  nodeSlug\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  nodeBaseIri\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  provenance\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eProvenanceBundleInput\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token maybe-class-name\"\u003eRdfDataset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Import and normalize a dataset into a flow\n */\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003eimportDatasetToFlow\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  sourcePath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  targetFlowPath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  nodeSlug\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  flowSlug\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  nodeBaseIri\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003ePromise\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan class=\"token keyword\"\u003evoid\u003c/span\u003e\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Derive node slug from folder name\n */\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003ederiveNodeSlug\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003enodePath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Compute node base IRI from path and namespace root\n */\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003ecomputeNodeBaseIri\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  nodePath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  namespaceRoot\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"23-flow-slug-constants\"\u003e2.3 Flow Slug Constants\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#23-flow-slug-constants\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLocation: \u003ca href=\"/sflo/../../shared/core/src/constants/flows.ts\"\u003e\u003ccode\u003eshared/core/src/constants/flows.ts\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Flow slug constants (from semantic-flow ontology)\n * \n * See: ontology/semantic-flow/_payload-flow/_working/semantic-flow-ontology.jsonld\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003eFLOW_SLUGS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eMETA\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"_meta\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eREF\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"_ref\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003ePAYLOAD\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"_payload\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eCFG_OP\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"_cfg-op\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eCFG_INH\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"_cfg-inh\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Snapshot folder names\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003eSNAPSHOT_FOLDERS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eWORKING\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"_working\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eDEFAULT\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"_default\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * System folder names\n */\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token constant\"\u003eSYSTEM_FOLDERS\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token constant\"\u003eHANDLE\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"_node-handle\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"24-filename-generation\"\u003e2.4 Filename Generation\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#24-filename-generation\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Generate distribution filename for a flow\n * \n * Payload: \u0026#x3C;nodeSlug\u003e.jsonld\n * Others: \u0026#x3C;nodeSlug\u003e_\u0026#x3C;flowSlug\u003e.jsonld\n * \n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003enodeSlug\u003c/span\u003e - Node slug\n * \u003cspan class=\"token keyword\"\u003e@param\u003c/span\u003e \u003cspan class=\"token parameter\"\u003eflowSlug\u003c/span\u003e - Flow slug (undefined for payload)\n * \u003cspan class=\"token keyword\"\u003e@returns\u003c/span\u003e Filename\n */\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003egenerateDistributionFilename\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n  nodeSlug\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  flowSlug\u003cspan class=\"token operator\"\u003e?\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e!\u003c/span\u003eflowSlug \u003cspan class=\"token operator\"\u003e||\u003c/span\u003e flowSlug \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token constant\"\u003eFLOW_SLUGS\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token constant\"\u003ePAYLOAD\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003enodeSlug\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e.jsonld\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token keyword control-flow\"\u003ereturn\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003enodeSlug\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eflowSlug\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e.jsonld\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"25-metadata-generation-strategy\"\u003e2.5 Metadata Generation Strategy\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#25-metadata-generation-strategy\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eThe v1 metadata will include:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eNode Description\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNode IRI: \u003ccode\u003e\u0026#x3C;\u003e\u003c/code\u003e (relative, resolves to node)\u003c/li\u003e\n\u003cli\u003eType: Placeholder or inferred from flows\u003c/li\u003e\n\u003cli\u003eLabel/description: Minimal stub\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eFlow Metadata\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMeta flow IRI: \u003ccode\u003e_meta/\u003c/code\u003e (relative)\u003c/li\u003e\n\u003cli\u003eFlow type: \u003ccode\u003esflo:NodeMetadataFlow\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eWeave label: Initial (e.g., \"2025-11-28_1112_00\")\u003c/li\u003e\n\u003cli\u003eSequence number: 1\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eProvenance (Minimal)\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNodeCreation activity stub\u003c/li\u003e\n\u003cli\u003eAgent reference (if provided)\u003c/li\u003e\n\u003cli\u003eRights/license (if provided)\u003c/li\u003e\n\u003cli\u003eNo full DelegationChain yet\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eRelative IRIs\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAll local references use relative IRIs\u003c/li\u003e\n\u003cli\u003eExternal vocabularies use absolute IRIs\u003c/li\u003e\n\u003cli\u003eNo \u003ccode\u003e@base\u003c/code\u003e in serialized output\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eExample metadata structure:\u003c/p\u003e\n\u003cpre class=\"language-jsonld\"\u003e\u003ccode class=\"language-jsonld\"\u003e{\n  \"@context\": {\n    \"sflo\": \"https://semantic-flow.github.io/ontology/semantic-flow/\",\n    \"dcat\": \"http://www.w3.org/ns/dcat#\",\n    \"dcterms\": \"http://purl.org/dc/terms/\",\n    \"prov\": \"http://www.w3.org/ns/prov#\"\n  },\n  \"@graph\": [\n    {\n      \"@id\": \"\",\n      \"@type\": \"sflo:BareNode\",\n      \"dcterms:title\": \"Node Title\"\n    },\n    {\n      \"@id\": \"_meta/\",\n      \"@type\": \"sflo:NodeMetadataFlow\",\n      \"sflo:weaveLabel\": \"2025-11-28_1112_00\",\n      \"sflo:versioningState\": { \"@id\": \"sflo:VersioningState/versioned/\" }\n    },\n    {\n      \"@id\": \"_meta/_default/\",\n      \"@type\": \"sflo:DefaultShot\",\n      \"sflo:sequenceNumber\": 1,\n      \"prov:wasGeneratedBy\": {\n        \"@id\": \"_meta/_default/#creation-activity\"\n      }\n    }\n  ]\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"26-directory-structure-created\"\u003e2.6 Directory Structure Created\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#26-directory-structure-created\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cpre\u003e\u003ccode\u003e\u0026#x3C;nodeTargetPath\u003e/\n├── _node-handle/\n│   └── README.md          # Stub explaining the handle concept\n├── _meta/\n│   ├── v1/\n│   │   └── \u0026#x3C;slug\u003e_meta.jsonld\n│   └── _default/\n│       └── \u0026#x3C;slug\u003e_meta.jsonld\n[optional flows if datasets provided:]\n├── _ref/\n│   ├── v1/\n│   │   └── \u0026#x3C;slug\u003e_ref.jsonld\n│   └── _default/\n│       └── \u0026#x3C;slug\u003e_ref.jsonld\n├── _payload/\n│   ├── v1/\n│   │   └── \u0026#x3C;slug\u003e.jsonld\n│   └── _default/\n│       └── \u0026#x3C;slug\u003e.jsonld\n├── _cfg-op/\n│   ├── v1/\n│   │   └── \u0026#x3C;slug\u003e_cfg-op.jsonld\n│   └── _default/\n│       └── \u0026#x3C;slug\u003e_cfg-op.jsonld\n└── _cfg-inh/\n    ├── v1/\n    │   └── \u0026#x3C;slug\u003e_cfg-inh.jsonld\n    └── _default/\n        └── \u0026#x3C;slug\u003e_cfg-inh.jsonld\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"27-error-handling\"\u003e2.7 Error Handling\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#27-error-handling\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eCustom error types in \u003ca href=\"/sflo/../../shared/core/src/errors/node-errors.ts\"\u003e\u003ccode\u003eshared/core/src/errors/node-errors.ts\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eNodeAlreadyExistsError\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eError\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003esuper\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eNode already exists at: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003epath\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ename\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"NodeAlreadyExistsError\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eDirectoryNotEmptyError\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eError\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003esuper\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eDirectory not empty: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003epath\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e. Use allowNonEmpty option to override.\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ename\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"DirectoryNotEmptyError\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eexport\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eclass\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eInvalidNodePathError\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eextends\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eError\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token function\"\u003econstructor\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epath\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e reason\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token builtin\"\u003estring\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003esuper\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eInvalid node path: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003epath\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e. Reason: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ereason\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ethis\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ename\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"InvalidNodePathError\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"3-simple-node-runner\"\u003e3. Simple Node Runner\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#3-simple-node-runner\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eLocation: \u003ca href=\"/sflo/../../scripts/create-node.ts\"\u003e\u003ccode\u003escripts/create-node.ts\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cpre class=\"language-typescript\"\u003e\u003ccode class=\"language-typescript\"\u003e\u003cspan class=\"token hashbang comment\"\u003e#!/usr/bin/env tsx\u003c/span\u003e\n\u003cspan class=\"token doc-comment comment\"\u003e/**\n * Simple CLI runner for createNode operation\n * \n * Usage:\n *   npx tsx scripts/create-node.ts \u0026#x3C;nodePath\u003e [--allow-non-empty]\n */\u003c/span\u003e\n\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e createNode \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"@semantic-flow/core\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003cspan class=\"token keyword module\"\u003eimport\u003c/span\u003e \u003cspan class=\"token imports\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e parseArgs \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003efrom\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"node:util\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003easync\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efunction\u003c/span\u003e \u003cspan class=\"token function\"\u003emain\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e values\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e positionals \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token function\"\u003eparseArgs\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    options\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token string-property property\"\u003e\"allow-non-empty\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e type\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"boolean\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003edefault\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003efalse\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    allowPositionals\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token boolean\"\u003etrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epositionals\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003elength\u003c/span\u003e \u003cspan class=\"token operator\"\u003e===\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"Usage: create-node \u0026#x3C;nodePath\u003e [--allow-non-empty]\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    process\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eexit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n  \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e nodePath \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e positionals\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token number\"\u003e0\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n  \u003cspan class=\"token keyword control-flow\"\u003etry\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003eCreating node at: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003enodePath\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \n    \u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e result \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003eawait\u003c/span\u003e \u003cspan class=\"token function\"\u003ecreateNode\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003enodePath\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      allowNonEmpty\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e values\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"allow-non-empty\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \u003cspan class=\"token keyword module\"\u003eas\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eboolean\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\\n✅ Node created successfully!\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e  Path: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003enodePath\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e  Slug: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003enodeSlug\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e  Base IRI: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003enodeBaseIri\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e\\nFlows created:\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e  Metadata: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003emeta\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eref\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e  Reference: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eref\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epayload\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e  Payload: \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003epayload\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecfgOp\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e  Config (Op): \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecfgOp\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token keyword control-flow\"\u003eif\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecfgInh\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003elog\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token string\"\u003e  Config (Inh): \u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003eresult\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003eflows\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecfgInh\u003c/span\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e \u003cspan class=\"token keyword control-flow\"\u003ecatch\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\\n❌ Error creating node:\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    \u003cspan class=\"token console class-name\"\u003econsole\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eerror\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror \u003cspan class=\"token keyword\"\u003einstanceof\u003c/span\u003e \u003cspan class=\"token class-name\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eError\u003c/span\u003e\u003c/span\u003e \u003cspan class=\"token operator\"\u003e?\u003c/span\u003e error\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003emessage\u003c/span\u003e \u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token known-class-name class-name\"\u003eString\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eerror\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n    process\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eexit\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e1\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\n\u003cspan class=\"token function\"\u003emain\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"4-testing-strategy\"\u003e4. Testing Strategy\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#4-testing-strategy\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"41-rdfsource-tests\"\u003e4.1 RdfSource Tests\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#41-rdfsource-tests\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eUnit tests for each function\u003c/li\u003e\n\u003cli\u003eFormat detection tests\u003c/li\u003e\n\u003cli\u003eBase IRI computation tests\u003c/li\u003e\n\u003cli\u003eRound-trip parse/serialize tests\u003c/li\u003e\n\u003cli\u003eError handling tests\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"42-createnode-tests\"\u003e4.2 createNode Tests\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#42-createnode-tests\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eLocation: \u003ca href=\"/sflo/../../shared/core/src/operations/__tests__/create-node.test.ts\"\u003e\u003ccode\u003eshared/core/src/operations/__tests__/create-node.test.ts\u003c/code\u003e\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eTest cases:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eCreate node in empty directory\u003c/li\u003e\n\u003cli\u003eFail on already-initialized node\u003c/li\u003e\n\u003cli\u003eFail on non-empty directory without flag\u003c/li\u003e\n\u003cli\u003eSucceed on non-empty with allowNonEmpty\u003c/li\u003e\n\u003cli\u003eCreate node with payload dataset\u003c/li\u003e\n\u003cli\u003eCreate node with reference dataset\u003c/li\u003e\n\u003cli\u003eCreate node with all optional datasets\u003c/li\u003e\n\u003cli\u003eValidate metadata content\u003c/li\u003e\n\u003cli\u003eValidate filename conventions\u003c/li\u003e\n\u003cli\u003eValidate directory structure\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"43-integration-tests\"\u003e4.3 Integration Tests\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#43-integration-tests\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eEnd-to-end scenarios:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eCreate node → read metadata → validate structure\u003c/li\u003e\n\u003cli\u003eCreate node → import dataset → verify relative IRIs\u003c/li\u003e\n\u003cli\u003eMultiple nodes in hierarchy\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"5-documentation-updates\"\u003e5. Documentation Updates\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#5-documentation-updates\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003ch3 id=\"51-parsing-semantics-spec\"\u003e5.1 Parsing Semantics Spec\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#51-parsing-semantics-spec\"\u003e\u003c/a\u003e\u003c/h3\u003e\n\u003cp\u003eUpdate the following documentation files:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"/sflo/../../documentation/concept.identifier.intramesh.relative.md\"\u003e\u003ccode\u003econcept.identifier.intramesh.relative.md\u003c/code\u003e\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAdd section on parsing with base IRI\u003c/li\u003e\n\u003cli\u003eAdd examples of relative IRI resolution\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"/sflo/../../documentation/concept.iri.md\"\u003e\u003ccode\u003econcept.iri.md\u003c/code\u003e\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAdd section on base IRI computation\u003c/li\u003e\n\u003cli\u003eAdd file:/// URL examples\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"/sflo/../../documentation/concept.implied-rdf-base.md\"\u003e\u003ccode\u003econcept.implied-rdf-base.md\u003c/code\u003e\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eAdd detailed parsing rules\u003c/li\u003e\n\u003cli\u003eAdd serialization rules\u003c/li\u003e\n\u003cli\u003eAdd examples\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003e\u003ca href=\"/sflo/../../documentation/concept.debasing.md\"\u003e\u003ccode\u003econcept.debasing.md\u003c/code\u003e\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFormalize the algorithm\u003c/li\u003e\n\u003cli\u003eAdd step-by-step examples\u003c/li\u003e\n\u003cli\u003eReference RdfSource functions\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eNew file: \u003ca href=\"/sflo/../../documentation/concept.rdf-source.md\"\u003e\u003ccode\u003econcept.rdf-source.md\u003c/code\u003e\u003c/a\u003e\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDocument the RdfSource abstraction\u003c/li\u003e\n\u003cli\u003eAPI reference\u003c/li\u003e\n\u003cli\u003eUsage examples\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"6-dependencies-to-add\"\u003e6. Dependencies to Add\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#6-dependencies-to-add\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eUpdate \u003ca href=\"/sflo/../../shared/core/package.json\"\u003e\u003ccode\u003eshared/core/package.json\u003c/code\u003e\u003c/a\u003e:\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"dependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@rdfjs/types\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^1.1.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@rdfjs/data-model\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^2.0.0\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"jsonld\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^8.3.2\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"n3\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^1.17.2\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"devDependencies\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@types/jsonld\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^1.5.13\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"@types/n3\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"^1.16.4\"\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch2 id=\"7-implementation-order\"\u003e7. Implementation Order\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#7-implementation-order\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003ePhase 1: RdfSource Foundation\u003c/strong\u003e (1-2 days)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eInstall dependencies\u003c/li\u003e\n\u003cli\u003eCreate type definitions\u003c/li\u003e\n\u003cli\u003eImplement core parsing/serialization\u003c/li\u003e\n\u003cli\u003eImplement helper functions\u003c/li\u003e\n\u003cli\u003eWrite unit tests\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003ePhase 2: createNode Core\u003c/strong\u003e (2-3 days)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eImplement path validation\u003c/li\u003e\n\u003cli\u003eImplement scaffolding functions\u003c/li\u003e\n\u003cli\u003eImplement metadata generation\u003c/li\u003e\n\u003cli\u003eImplement optional dataset import\u003c/li\u003e\n\u003cli\u003eWrite unit tests\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003ePhase 3: Integration\u003c/strong\u003e (1 day)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCreate runner script\u003c/li\u003e\n\u003cli\u003eWrite integration tests\u003c/li\u003e\n\u003cli\u003eManual testing\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003ePhase 4: Documentation\u003c/strong\u003e (1 day)\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eUpdate concept docs\u003c/li\u003e\n\u003cli\u003eAdd API documentation\u003c/li\u003e\n\u003cli\u003eUpdate task files\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e\u003cstrong\u003eTotal estimated time: 5-7 days\u003c/strong\u003e\u003c/p\u003e\n\u003ch2 id=\"8-future-enhancements-out-of-scope\"\u003e8. Future Enhancements (Out of Scope)\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#8-future-enhancements-out-of-scope\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThese are explicitly \u003cstrong\u003enot\u003c/strong\u003e part of this task:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFull debasing algorithm with IRI rewriting\u003c/li\u003e\n\u003cli\u003ePayload unpacking into child nodes\u003c/li\u003e\n\u003cli\u003eConfig inheritance from parent nodes\u003c/li\u003e\n\u003cli\u003eFull PROV/DelegationChain modeling\u003c/li\u003e\n\u003cli\u003eSHACL validation\u003c/li\u003e\n\u003cli\u003eRDF store integration\u003c/li\u003e\n\u003cli\u003eCLI framework (Oclif) integration\u003c/li\u003e\n\u003cli\u003eInteractive mode with prompts\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2 id=\"9-success-criteria\"\u003e9. Success Criteria\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#9-success-criteria\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cp\u003eThe implementation is complete when:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e✅ RdfSource can parse JSON-LD and Turtle with explicit base\u003c/li\u003e\n\u003cli\u003e✅ RdfSource can serialize mesh-native JSON-LD (no \u003ca title=\"Private\" href=\"https://wiki.dendron.so/notes/hfyvYGJZQiUwQaaxQO27q.html\" target=\"_blank\" class=\"private\"\u003e@base (Private)\u003c/a\u003e, relative IRIs)\u003c/li\u003e\n\u003cli\u003e✅ createNode creates correct directory structure\u003c/li\u003e\n\u003cli\u003e✅ createNode generates valid v1 metadata\u003c/li\u003e\n\u003cli\u003e✅ createNode can import optional datasets\u003c/li\u003e\n\u003cli\u003e✅ All tests pass (unit + integration)\u003c/li\u003e\n\u003cli\u003e✅ Documentation is updated\u003c/li\u003e\n\u003cli\u003e✅ Simple runner script works\u003c/li\u003e\n\u003cli\u003e✅ Code follows project conventions\u003c/li\u003e\n\u003cli\u003e✅ Task files are updated with progress\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"references\"\u003eReferences\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#references\"\u003e\u003c/a\u003e\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/sflo/./task.2025-11-28-rdfsource-debasing-parsing.md\"\u003etask.2025-11-28-rdfsource-debasing-parsing\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/sflo/./task.2025-11-27-createNode.md\"\u003etask.2025-11-27-createNode\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/sflo/./concept.identifier.intramesh.relative.md\"\u003econcept.identifier.intramesh.relative\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/sflo/./concept.implied-rdf-base.md\"\u003econcept.implied-rdf-base\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/sflo/./concept.debasing.md\"\u003econcept.debasing\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/sflo/./concept.weave-process.md\"\u003econcept.weave-process\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"/sflo/./dev.general-guidance.md\"\u003edev.general-guidance\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003cstrong\u003eBacklinks\u003c/strong\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"/sflo/notes/ufnbtre0tn2pxq7dzjcgrz0\"\u003e2025-11-27-createNode\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e","noteIndex":{"id":"voy7zrf0f6bs86m02uadhaf","title":"Semantic Flow Documentation","desc":"","updated":1756155165637,"created":1755709990079,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":"documentation","selfContained":false,"name":"sflo"},"contentHash":"98cbbdb73a40d62308166fed9c2f594f","links":[{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"now","position":{"start":{"line":4,"column":1,"offset":107},"end":{"line":4,"column":8,"offset":114},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"now"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"todo","position":{"start":{"line":4,"column":11,"offset":117},"end":{"line":4,"column":19,"offset":125},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"todo"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"principle","position":{"start":{"line":4,"column":22,"offset":128},"end":{"line":4,"column":35,"offset":141},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"principle"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"dev.contributor.djradon.dev-log","position":{"start":{"line":4,"column":38,"offset":144},"end":{"line":4,"column":73,"offset":179},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"dev.contributor.djradon.dev-log"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"concept.single-mesh-repo","position":{"start":{"line":10,"column":1,"offset":498},"end":{"line":10,"column":29,"offset":526},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"concept.single-mesh-repo"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"concept.mesh","position":{"start":{"line":10,"column":47,"offset":544},"end":{"line":10,"column":63,"offset":560},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"concept.mesh"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"concept.semantic-flow-site","position":{"start":{"line":10,"column":112,"offset":609},"end":{"line":10,"column":142,"offset":639},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"concept.semantic-flow-site"}},{"type":"wiki","from":{"fname":"root","id":"voy7zrf0f6bs86m02uadhaf","vaultName":"sflo"},"value":"feature","position":{"start":{"line":23,"column":7,"offset":1053},"end":{"line":23,"column":18,"offset":1064},"indent":[]},"xvault":false,"sameFile":false,"to":{"fname":"feature"}}],"anchors":{"what-is-semantic-flow":{"type":"header","text":"What Is Semantic Flow?","value":"what-is-semantic-flow","line":12,"column":0,"depth":2},"benefits":{"type":"header","text":"Benefits","value":"benefits","line":18,"column":0,"depth":2},"features":{"type":"header","text":"Features","value":"features","line":25,"column":0,"depth":2}},"children":["completed-tasks","p0vd6xnshcxw14ztkglxyxn","qa6hqxy4tknnmutvq13onaq","sfgrcjcttxz7b3qov7efg3f","facets","faq000","ggle3sz2jv3vf53t9qplrzo","mesh-file","mesh-folder","guides","mesh-resource","yxn5rsqsv2gq4s6wbnxsjsj","l9g8eki3dtir51o4jagac5a","28q7fh05bs691llgv7htxnw","products","tkw34hrqxficesa0y2r62s0","tasks","xqjr13fyons9goxv8rjrskj","use-cases","8wh7p4aps8humop7vqymk3n"],"parent":null,"data":{},"body":"\n**Dereferenceable, versioned semantic meshes** will be the foundation for a new era of knowledge graphs.\n\n[[now]] | [[todo]] | [[principle]] | [[dev.contributor.djradon.dev-log]]\n\n## What Is Semantic Flow?\n\n**Semantic Flow** is a framework for managing and publishing resource identifiers, knowledge graphs and other semantic data by leveraging GitHub, Gitlab, and other free static hosting services. It enables a **dereferenceable Semantic Web** where every HTTP IRI returns meaningful content.\n\n[[concept.single-mesh-repo]] provide storage, [[concept.mesh]] provide resource management and publishing, and [[concept.semantic-flow-site]] support data discovery and explainability.\n\n## Benefits\n\n- own your own self-describing data and data schemas\n- complete version history when you want it\n- reliable persistence\n- truly FAIR (Findable, Accessible, Interoperable, and Reusable)\n\n## Features\n\n- seamlessly integrate other data sources anywhere in your mesh\n- generate and customize mini-sites or single-page applications for nodes in your mesh\n- see [[feature]] for a list of planned features\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"none","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"selection","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":"documentation","selfContained":false,"name":"sflo"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Semantic Flow Docs","description":"A dendron-based wiki for sflo"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://semantic-flow.github.io/sflo","assetsPrefix":"/sflo","siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"architecture-plan-rdfsource-createnode"},"buildId":"stable-build-id","assetPrefix":"/sflo","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>